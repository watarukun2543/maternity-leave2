<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‚²ä¼‘ç”£ä¼‘ ä½œæ¥­ãƒªã‚¹ãƒˆ</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‘¶</text></svg>">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <style>body{margin:0;padding:0;font-family:"Noto Sans JP",-apple-system,BlinkMacSystemFont,sans-serif}#root{min-height:100vh}</style>
</head>
<body>
  <div id="root"></div>
  <script>
    try {
      const firebaseConfig={apiKey:"AIzaSyCLx6XKvsKhdhX-p1RhIihVy4_BT78r4pU",authDomain:"maternity-leave-e4375.firebaseapp.com",projectId:"maternity-leave-e4375",storageBucket:"maternity-leave-e4375.firebasestorage.app",messagingSenderId:"94532746370",appId:"1:94532746370:web:07a730c47040ac2347889b"};
      firebase.initializeApp(firebaseConfig);
      window.db=firebase.firestore();
      window._fbReady = true;
    } catch(e) {
      console.warn("Firebase init failed:", e);
      window._fbReady = false;
    }
  </script>
  <script type="text/babel">
window.storage={
  async get(key){
    if(window._fbReady){try{const doc=await window.db.collection("appdata").doc(key).get();if(doc.exists)return{key,value:doc.data().value}}catch(e){}}
    const val=localStorage.getItem("ml_"+key);if(val===null)throw new Error("Key not found");return{key,value:val}
  },
  async set(key,value){
    if(window._fbReady){try{await window.db.collection("appdata").doc(key).set({value,updatedAt:firebase.firestore.FieldValue.serverTimestamp()});localStorage.setItem("ml_"+key,value);return{key,value}}catch(e){}}
    localStorage.setItem("ml_"+key,value);return{key,value}
  },
  async delete(key){
    if(window._fbReady){try{await window.db.collection("appdata").doc(key).delete()}catch(e){}}
    localStorage.removeItem("ml_"+key);return{key,deleted:true}
  },
  async list(prefix){
    const keys=[];
    if(window._fbReady){try{const snap=await window.db.collection("appdata").get();snap.forEach(doc=>{if(!prefix||doc.id.startsWith(prefix))keys.push(doc.id)})}catch(e){}}
    return{keys}
  }
};
const { useState, useEffect, useMemo, useCallback, useRef } = React;

// ============================================================
// è‚²ä¼‘ç”£ä¼‘ä½œæ¥­ãƒªã‚¹ãƒˆ ã‚¢ãƒ—ãƒª
// ============================================================

// --- Sample Data (imported from Excel) ---
const COMPANIES = [
  "(æœ‰)ã‚»ãƒ¬ãƒ¢ãƒ‹ãƒ¼ãƒ›ãƒ¼ãƒ«ã•ã ã¿ã¤", "ã‚ã‚æ­¯ç§‘ã“ã©ã‚‚æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯", "ãƒãƒ¥ãƒ­ã‚¹ãŠã˜ã•ã‚“ åˆåŒä¼šç¤¾",
  "å…ç‰äº‹å‹™æ‰€", "å¤§æ­©å±å³¡è¦³å…‰éŠèˆ¹ æœ‰é™ä¼šç¤¾", "å®®åŸã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "å²¡ç”°çµ„",
  "å¾³å³¶åˆåŒè¨¼åˆ¸ æ ªå¼ä¼šç¤¾", "æœ‰é™ä¼šç¤¾ ã‚¨ãƒ ã‚ºã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³", "æœ‰é™ä¼šç¤¾ ãƒã‚¹ãƒ€è‡ªå‹•è»Š",
  "æœ‰é™ä¼šç¤¾ åŸç”°é£Ÿå“", "æœ‰é™ä¼šç¤¾ å¦™å¤è¨­å‚™", "æœ‰é™ä¼šç¤¾ å®®å´å•†åº—",
  "æ ªå¼ä¼šç¤¾ en", "æ ªå¼ä¼šç¤¾ ã‚¢ãƒ«ãƒ•ã‚¡ãƒªãƒ³ã‚¯ã‚¹", "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹",
  "æ ªå¼ä¼šç¤¾ ã‚¹ãƒšãƒƒã‚¯", "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "æ ªå¼ä¼šç¤¾ ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ‰ã‚¯ã‚¿ãƒ¼ã‚»ãƒ«ãƒ ã‚¹",
  "æ ªå¼ä¼šç¤¾ å—æµ·ï¼­ï¼ªï¼¥", "æ ªå¼ä¼šç¤¾ å¤§ å‰µ", "æ ªå¼ä¼šç¤¾ æ—­æœ¨å·¥",
  "æ ªå¼ä¼šç¤¾ æ—­æœ¨å·¥ (ã‚±ã‚¢ã‚µãƒ¼ãƒ“ã‚¹äº‹æ¥­éƒ¨)", "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "æ ªå¼ä¼šç¤¾ æ—ç£åŒ»ç§‘ç—…é™¢",
  "æ ªå¼ä¼šç¤¾ ç”°åŸå·¥æ¥­", "æ ªå¼ä¼šç¤¾ ï¼¡ï¼§ï¼®", "æ ªå¼ä¼šç¤¾ ï¼³Ğï¼µ",
  "æ¸…è¦‹é›»æ°—å·¥äº‹ æ ªå¼ä¼šç¤¾", "ç±³ç²‰ãƒãƒ¥ãƒ­ã‚¹ã‚¸ãƒ£ãƒ‘ãƒ³ æ ªå¼ä¼šç¤¾", "é³´é–€ã‚¬ã‚¹ æ ªå¼ä¼šç¤¾",
];


const STAFF = ["æ¥ æœ¬", "è”µæœ¬", "æ¨ªäº•", "å…ç‰", "æ¸•", "å·äºº", "ç¦æ°¸", "å²©é‡"];

const INSURANCE_TYPES = ["ç¤¾ï¼é›‡", "é›‡ç”¨ä¿é™ºã®ã¿"];

const APPLICATION_TYPES = [
  "ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹", "è‚²ä¼‘å…é™¤ç”³è«‹",
  "è‚²å…çµ¦ä»˜é‡‘ / åˆå›", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®",
  "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®",
  "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®",
  "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®",
];

const INITIAL_DATA = [
  {"id": 1, "regDate": "2023-03-01", "returnDate": "", "company": "å¤§æ­©å±å³¡è¦³å…‰éŠèˆ¹ æœ‰é™ä¼šç¤¾", "staff": "è”µæœ¬", "name": "è”¡ æ€¡è±", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2025-02-19", "birthDate": "", "childName": "è”µæ•·", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/06/13  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/10/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/10/24  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/12/23  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/03/03  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/05/12  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/06/04  æ¸•", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2023/2/28 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®": "2023/4/25 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®": "2023/4/25ã«è·å ´å¾©å¸°", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®": "2023/4/25ã«è·å ´å¾©å¸°"}},
  {"id": 2, "regDate": "2023-03-01", "returnDate": "", "company": "æœ‰é™ä¼šç¤¾ å®®å´å•†åº—", "staff": "è”µæœ¬", "name": "å°æ— å¹¸å­", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2021-08-14", "birthDate": "2021-08-22", "childName": "å°æ—", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 3, "regDate": "2023-03-01", "returnDate": "", "company": "æœ‰é™ä¼šç¤¾ ã‚¨ãƒ ã‚ºã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³", "staff": "è”µæœ¬", "name": "æ­¦å¸‚ ã‚ã‚†ã¿", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-07-28", "birthDate": "2022-07-27", "childName": "æ­¦å¸‚", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "æœ‰", "notes": "2024/02/02ã€€ï¼ã€€R6.7.26ã¾ã§è‚²ä¼‘å»¶é•·ã€€å…ç‰", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2022/8/16 å°å·", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2022/10/3 è”µæœ¬", "è‚²ä¼‘å…é™¤ç”³è«‹": "2022/10/11 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2022/12/7 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/2/13 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/4/4 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/06/07  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/08/01 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/10/20  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2023/12/13  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/02/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/04/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®": "2024/06/19", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®": "2024/08/08  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®": "2024/08/08  å…ç‰"}},
  {"id": 4, "regDate": "2023-03-01", "returnDate": "2023-04-11", "company": "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "staff": "è”µæœ¬", "name": "äº€ç”° çœŸæ„›", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-07-22", "birthDate": "2022-07-20", "childName": "äº€ç”°(ç¬¬2å­)", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "å¾©å¸°å¾Œã€çµ‚äº†å±Šæå‡ºæ¸ˆ", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2022/12/16 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/1/7 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/4/4 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/06/01  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "4æœˆå¾©å¸°ã®ç‚ºã€ä»¥é™ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "4æœˆå¾©å¸°ã®ç‚ºã€ä»¥é™ç”³è«‹ãªã—"}},
  {"id": 5, "regDate": "2023-03-01", "returnDate": "2023-05-07", "company": "æœ‰é™ä¼šç¤¾ å¦™å¤è¨­å‚™", "staff": "è”µæœ¬", "name": "è’æœ¨ ç€¬å¥ˆ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-05-06", "birthDate": "2022-05-07", "childName": "è’æœ¨", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R5.5.7ã«è·å ´å¾©å¸°", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/3/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/5/24 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/5/24 å²©é‡"}},
  {"id": 6, "regDate": "2023-03-01", "returnDate": "", "company": "æœ‰é™ä¼šç¤¾ ãƒã‚¹ãƒ€è‡ªå‹•è»Š", "staff": "è”µæœ¬", "name": "è—¤æœ¬ å®ç¾", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-09-09", "birthDate": "2022-09-13", "childName": "å¤§é›…", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R5.3.31é¡§å•å¥‘ç´„çµ‚äº†", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/3/16 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "R4.3.31ã§å¥‘ç´„çµ‚äº†", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "R4.3.31ã§å¥‘ç´„çµ‚äº†", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "R4.3.31ã§å¥‘ç´„çµ‚äº†", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "R4.3.31ã§å¥‘ç´„çµ‚äº†"}},
  {"id": 7, "regDate": "2023-03-01", "returnDate": "2023-06-01", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "å²¡ç”° å½©èŠ±", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2022-01-20", "birthDate": "2022-01-16", "childName": "å²¡ç”°", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/3/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2023/06/01  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2023/06/01  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "6/1ã§è·å ´å¾©å¸°"}},
  {"id": 8, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "å¤§ä¹…ä¿ å½©è¯", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2022-06-20", "birthDate": "2022-06-20", "childName": "å¤§ä¹…ä¿", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "2023/06/22 6/14ã«ç¬¬2å­å‡ºç”£ï¼ˆé©ç”¨èª²ã«ç¢ºèªã—ã¦ç¬¬1å­ã®è‚²å…ä¼‘æ¥­çµ¦ä»˜é‡‘ã¯èª•ç”Ÿæ—¥ã®å‰ã€…æ—¥ã¾ã§OKï¼‰ å²©é‡", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2022/11/25 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/1/5 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/3/7 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/4/18 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/06/22  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/06/22  å²©é‡"}},
  {"id": 9, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "staff": "è”µæœ¬", "name": "æ— æ„›å­", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-11-23", "birthDate": "2022-11-27", "childName": "è‰ç·’", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "çˆ¶:ç¾©æ–‡ã•ã‚“è‚²ä¼‘å–å¾—", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2022/12/16 ç¦æ°¸", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/01/31  ç¦æ°¸", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/2/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/04/10  ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/06/01  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/07/25  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/10/02  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/12/11  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/02/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/04/04  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/05/08  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/05/08  å…ç‰"}},
  {"id": 10, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "å¹¸ç”° æ˜¥ä½³", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2022-07-13", "birthDate": "2022-07-14", "childName": "å¹¸ç”°", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R5.1.14 â†’ R5.7.14ã¾ã§è‚²ä¼‘", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/3/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/5/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/07/24  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/07/24  å²©é‡"}},
  {"id": 11, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "ä½æ¢ çœŸå¼“", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2022-10-11", "birthDate": "2022-09-28", "childName": "ä½æ¢", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R5.3.31ã§é€€è· å²©é‡", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/2/15 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/3/29 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "R5.3.31 é€€è· å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "R5.3.31 é€€è· å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "R5.3.31 é€€è· å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "R5.3.31 é€€è· å²©é‡"}},
  {"id": 12, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "staff": "è”µæœ¬", "name": "æ¾å³¶ çœŸç´€", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-02-23", "birthDate": "2023-03-01", "childName": "æ¥“çœŸï¼ˆãµã†ã¾ï¼‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "çˆ¶ï¼šæ¾å³¶é›„ä¸€ï¼ˆæœæ—¥å±‹ç¤¾å“¡ï¼‰", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/3/6 ç¦æ°¸", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/5/2 å²©é‡", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/5/1 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/07/03  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/09/04  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/11/09  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/01/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/03/05  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/05/08  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/12/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/12/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/12/11  å…ç‰"}},
  {"id": 13, "regDate": "2023-03-01", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "staff": "è”µæœ¬", "name": "ä¸­ç”° åƒæ™¶", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-03-12", "birthDate": "2023-03-12", "childName": "ä¸­ç”°", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/5/2 å²©é‡", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/5/22 å²©é‡", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/5/12 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/07/25  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/09/12  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/11/09  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/01/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/03/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/04/04  å…ç‰"}},
  {"id": 14, "regDate": "2023-03-07", "returnDate": "", "company": "å®®åŸã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "èŠå· ç¾ç·’(å®®åŸã‚¬ã‚¹)", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-05-19", "birthDate": "2022-05-19", "childName": "èŠå·", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "4/1ã‹ã‚‰å®®åŸã‚¬ã‚¹â†’é³´é–€ã‚¬ã‚¹ã¸ç§»ç±", "applications": {"è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/1/16 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/3/24 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/4/10 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "é³´é–€ã‚¬ã‚¹ã¸"}},
  {"id": 15, "regDate": "2023-03-07", "returnDate": "2024-04-21", "company": "é³´é–€ã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "è°·å· æœ±é‡Œ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-10-19", "birthDate": "2022-10-17", "childName": "è°·å·", "subsidy": "æœ‰", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "R6.4.17ã¾ã§å»¶é•·", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/2/6 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/4/17 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/06/19  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/08/17  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/10/25  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/12/13  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/02/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/04/24  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/04/24  å…ç‰"}},
  {"id": 16, "regDate": "2023-03-08", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ å—æµ·ï¼­ï¼ªï¼¥", "staff": "æ¥ æœ¬", "name": "å–œå¤š èŠ½ç”Ÿ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-05-19", "birthDate": "", "childName": "å–œå¤š", "subsidy": "æœ‰", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "ç¤¾ä¿ãƒ»é›‡ä¿ã€€æ‰‹ç¶šãã¯ãªã—ï¼ˆæœ¬ç¤¾ç¤¾åŠ´å£«ãŒã™ã‚‹ï¼‰", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "ç”³è«‹ãªã—", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "ç”³è«‹ãªã—", "è‚²ä¼‘å…é™¤ç”³è«‹": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "ç”³è«‹ãªã—"}},
  {"id": 17, "regDate": "2023-03-09", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æ—­æœ¨å·¥", "staff": "æ¨ªäº•", "name": "èµ¤ï¨‘ ã¾ã‚Šãˆ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-10-28", "birthDate": "2022-10-28", "childName": "èµ¤ï¨‘", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "å®Ÿéš›ç”£ä¼‘ã«å…¥ã£ãŸæ—¥ä»˜ã¯9/20", "applications": {"è‚²ä¼‘å…é™¤ç”³è«‹": "2023/2/6 æ¨ªäº•", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/3/16 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/5/1 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/07/04  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/09/20  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/11/14  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/01/11  æ¨ªäº•"}},
  {"id": 18, "regDate": "2022-05-31", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "è«¸å²¡ å„ªä½³", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-09-28", "birthDate": "2022-09-25", "childName": "æ˜è‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ    å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/4/4 å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/05/30  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/07/28 å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/10/13  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/12/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/02/05  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/04/01  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/05/23  å…ç‰"}},
  {"id": 19, "regDate": "2022-11-01", "returnDate": "2024-04-01", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "é›£æ³¢ ç¾æ¡œé‡Œ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-10-21", "birthDate": "2022-10-13", "childName": "å¥å¤š", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "æ¸ˆ", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "æ¸ˆ", "è‚²ä¼‘å…é™¤ç”³è«‹": "æ¸ˆ", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "æ¸ˆ    å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/4/20 å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/06/29  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/08/31  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/10/18  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/12/20  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/02/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/04/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/06/10  å…ç‰"}},
  {"id": 20, "regDate": "2023-01-12", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "å‰ç”° çµ¢é¦™", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-07-11", "birthDate": "2023-07-14", "childName": "å‰ç”°éƒ½è‘µ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/05/31  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/09/25 è‡ªç¤¾å¯¾å¿œ", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/09/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/11/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/01/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/03/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/05/23  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/05/23  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/05/23  å…ç‰"}},
  {"id": 21, "regDate": "2023-03-29", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "æ–°äº• ã‚ãã¿", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-07-11", "birthDate": "2023-07-12", "childName": "æ–°äº•çµæ„›", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/05/31  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/09/25 è‡ªç¤¾å¯¾å¿œ", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/09/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/11/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/01/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/03/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/05/23  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/05/23  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/05/23  å…ç‰"}},
  {"id": 22, "regDate": "2023-01-25", "returnDate": "", "company": "å¾³å³¶åˆåŒè¨¼åˆ¸ æ ªå¼ä¼šç¤¾", "staff": "æ¨ªäº•", "name": "æ¸…æ°´ ç”±é¦™åˆ©", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-02-02", "birthDate": "2023-01-23", "childName": "å¤§æš‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/2/6 å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/2/6 å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/4/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/06/5  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/08/09  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/10/06  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/02/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/02/06  æ¨ªäº•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/04/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/06/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/06/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/06/12  å…ç‰"}},
  {"id": 23, "regDate": "2023-03-30", "returnDate": "", "company": "æœ‰é™ä¼šç¤¾ åŸç”°é£Ÿå“", "staff": "æ¨ªäº•", "name": "æ¾ä¹… èŒœ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-11-22", "birthDate": "2022-12-01", "childName": "èŠ½ä¾", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "æœ‰", "notes": "ç”£å‰ä¼‘æ¥­ã€€R4.11.1ã‹ã‚‰é–‹å§‹", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2022/12/19 ç¦æ°¸", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/3/6 ç¦æ°¸", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/3/2 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/4/6 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/06/05  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/08/09  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/10/13  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/06/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/06/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/06/27", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/07/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/08/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®": "2024/10/22  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®": "2024/12/13  æ¸•", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®": "2024/12/13  æ¸•"}},
  {"id": 24, "regDate": "2023-03-07", "returnDate": "2023-11-21", "company": "é³´é–€ã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "èŠå· ç¾ç·’(é³´é–€ã‚¬ã‚¹)", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2022-05-19", "birthDate": "2022-05-19", "childName": "èŠå·", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "4/1ã‹ã‚‰å®®åŸã‚¬ã‚¹â†’é³´é–€ã‚¬ã‚¹ã¸ç§»ç±ã€€5å›ç›®è‚²ä¼‘ã®é–‹å§‹æ—¥4/1ã§å†ç”³è«‹", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/4/12 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "å®®åŸã‚¬ã‚¹ã‹ã‚‰ç§»ç±", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/06/02  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2023/10/11  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2023/11/20  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "è·å ´å¾©å¸°æ¸ˆã¿ å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®": "è·å ´å¾©å¸°æ¸ˆã¿ å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®": "è·å ´å¾©å¸°æ¸ˆã¿ å²©é‡", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®": "è·å ´å¾©å¸°æ¸ˆã¿ å²©é‡"}},
  {"id": 25, "regDate": "", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ï¼³Ğï¼µ", "staff": "è”µæœ¬", "name": "ä¸­è¥¿ æ™ºå®Ÿ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2023-01-14", "birthDate": "2022-12-31", "childName": "å¦¥ç©‚ï¼ˆãŸãŠï¼‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/2/9 ç¦æ°¸", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/3/8 ç¦æ°¸", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/2/9 ç¦æ°¸", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/5/11 å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/07/13  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/09/04  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/11/08  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/01/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/03/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/05/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2024/05/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2024/05/10  å…ç‰"}},
  {"id": 26, "regDate": "2023-05-09", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ç”°åŸå·¥æ¥­", "staff": "è”µæœ¬", "name": "å·äºº è£•åŠ é‡Œ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "", "birthDate": "2022-06-30", "childName": "ï¼Ÿ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "SRäº‹å‹™çµ„åˆ", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "è‚²ä¼‘å…é™¤ç”³è«‹": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "é¡§å•å¥‘ç´„ä»¥å‰ã«ä»–ã§æ‰‹ç¶š", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "å„æœˆç”³è«‹ å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/07/12  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/07/12  å²©é‡"}},
  {"id": 27, "regDate": "2023-05-08", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ï¼³Ğï¼µ", "staff": "è”µæœ¬", "name": "å°ç¬  æå¯å­", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2023-08-04", "dueDate": "2023-09-14", "birthDate": "2023-09-05", "childName": "å°ç¬ ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "2023/08/09ã€€ï¼ã€€8/4ã‹ã‚‰ç”£å‰ä¼‘æ¥­é–‹å§‹ã€€å²©é‡", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/08/09  å²©é‡", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/11/16  å²©é‡", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/11/16  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/02/01  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/03/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/05/07  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/07/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/09/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/09/06  å…ç‰"}},
  {"id": 28, "regDate": "2023-05-22", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚¢ãƒ«ãƒ•ã‚¡ãƒªãƒ³ã‚¯ã‚¹", "staff": "è”µæœ¬", "name": "ç‰ç”° è‚²å­", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2023-08-16", "birthDate": "2023-08-12", "childName": "ç‰ç”°", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "å¸ç‹åˆ‡é–‹äºˆå®š", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "ç”³è«‹ãªã—", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "ç”³è«‹ãªã—", "è‚²ä¼‘å…é™¤ç”³è«‹": "ç”³è«‹ãªã—", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2023/08/31 è‡ªç¤¾ã§ç”³è«‹äºˆå®š å²©é‡"}},
  {"id": 29, "regDate": "2022-12-16", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ï¼¡ï¼§ï¼®", "staff": "æ¥ æœ¬", "name": "ç”°ä¸­ èˆ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2023-05-27", "dueDate": "2023-07-07", "birthDate": "2023-07-12", "childName": "ä½‘èŒ‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "æœ‰", "ext2": "æœ‰", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/6/22 ç”³è«‹", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2023/09/22 éƒµé€ å²©é‡", "è‚²ä¼‘å…é™¤ç”³è«‹": "2023/09/11  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/11/09  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/01/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/03/07  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/05/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/07/12  æ¥ æœ¬", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/09/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®": "2024/11/15  æ¸•", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®": "2025/01/14  æ¸•", "è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®": "2025/03/11  å·äºº", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®": "2025/05/21  å·äºº", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®": "2025/05/21  å·äºº", "è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®": "2025/05/21  å·äºº"}},
  {"id": 30, "regDate": "2023-06-22", "returnDate": "", "company": "ã‚ã‚æ­¯ç§‘ã“ã©ã‚‚æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯", "staff": "è”µæœ¬", "name": "å®®ç”° èœå¤®", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-01-24", "birthDate": "2024-02-01", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2023/12/21  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/06/10  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/07/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/08/01  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/10/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/12/09  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/03/06  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/03/06  æ¸•"}},
  {"id": 31, "regDate": "2023-08-31", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚¢ãƒ«ãƒ•ã‚¡ãƒªãƒ³ã‚¯ã‚¹", "staff": "è”µæœ¬", "name": "ã‹ã˜ ã•ã‚‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-03-31", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 32, "regDate": "2023-09-13", "returnDate": "2025-04-22", "company": "æ ªå¼ä¼šç¤¾ ï¼¡ï¼§ï¼®", "staff": "æ¥ æœ¬", "name": "æ–°é–‹ å¸Œä¸–", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2024-03-06", "dueDate": "2024-04-14", "birthDate": "2024-04-22", "childName": "å¥å¤ªéƒ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/04/18  æ¥ æœ¬", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/06/27", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/06/20  æ¥ æœ¬", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/08/30  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/10/22  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/12/18  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/02/25  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/23  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/23  å·äºº"}},
  {"id": 33, "regDate": "2023-10-11", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ï¼³Ğï¼µ", "staff": "è”µæœ¬", "name": "æ£®æœ¬ æ¯¬æ„›", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-02-08", "birthDate": "2024-02-11", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/01/11  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/04/11  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/04/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/06/13  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/08/08  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/10/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/12/07  æ¸•"}},
  {"id": 34, "regDate": "2023-10-12", "returnDate": "", "company": "ãƒãƒ¥ãƒ­ã‚¹ãŠã˜ã•ã‚“ åˆåŒä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "ä¼Šå‹¢ å¥ˆæ´¥å®Ÿ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2024-03-30", "dueDate": "2024-05-06", "birthDate": "2024-04-22", "childName": "å¥å¤ªéƒ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/03/26  æ¥ æœ¬", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/06/27  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/06/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/08/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/10/22  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/12/18  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/03/06  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/28  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/28  å·äºº"}},
  {"id": 35, "regDate": "2023-11-06", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "å¤§ä¹…ä¿ å½©è¯ï¼ˆæ¹Šå£«ï¼‰", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2023-06-29", "birthDate": "2023-06-14", "childName": "æ¹Šå£«", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "2023/11/06ã€€ï¼ã€€è·å ´å¾©å¸°äºˆå®šã€€R6.6.14ã€€å²©é‡", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2023/11/07  å²©é‡", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/12/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/02/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2024/04/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2024/07/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2024/07/12  å…ç‰"}},
  {"id": 36, "regDate": "2023-12-20", "returnDate": "", "company": "ã‚ã‚æ­¯ç§‘ã“ã©ã‚‚æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯", "staff": "è”µæœ¬", "name": "å®®ç”°èœå¤®", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-01-24", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "2023/12/21 / å®®ç”°å¥ˆå¤®åˆ¥ã§ç®¡ç†æ¸ˆã¿", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2023/12/21  å…ç‰"}},
  {"id": 37, "regDate": "2024-01-16", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "é›£æ³¢ ç¾æ¡œé‡Œï¼ˆç¬¬2å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2024-04-01", "dueDate": "2024-05-05", "birthDate": "2024-04-21", "childName": "æ˜´å¤š", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/04/04  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/06/21  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/06/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/08/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/10/29  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/01/27  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/03/04  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/24  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/24  å…ç‰"}},
  {"id": 38, "regDate": "2024-02-01", "returnDate": "2025-05-01", "company": "æ ªå¼ä¼šç¤¾ ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ‰ã‚¯ã‚¿ãƒ¼ã‚»ãƒ«ãƒ ã‚¹", "staff": "è”µæœ¬", "name": "å¯Œæ¾¤ å§”æµ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-07-01", "birthDate": "2024-06-20", "childName": "ç’ƒå¤®æ–—", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/06/12  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/11/13  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/12/18  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/03/05  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/04/18  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/05/26  æ¸•"}},
  {"id": 39, "regDate": "2024-02-14", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ã‚¹ãƒšãƒƒã‚¯", "staff": "è”µæœ¬", "name": "å‚è©° ç ‚ä¿é‡Œ", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2024-08-30", "birthDate": "2024-08-24", "childName": "", "subsidy": "æœ‰", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/01/31  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/03/03  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/05/07  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/07/09  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/08/22  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/08/28  æ¸•"}},
  {"id": 40, "regDate": "2024-02-27", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æœæ—¥å±‹", "staff": "è”µæœ¬", "name": "äº€ç”° çœŸæ„›ï¼ˆç¬¬3å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-04-12", "birthDate": "2024-03-31", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/04/04  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/06/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/08/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/10/09  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2024/11/29  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/02/03  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/04  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/04  æ¸•"}},
  {"id": 41, "regDate": "2024-02-28", "returnDate": "", "company": "ã‚ã‚æ­¯ç§‘ã“ã©ã‚‚æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯", "staff": "è”µæœ¬", "name": "å‚äº• å¿—ä¿", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-08-01", "birthDate": "2024-07-29", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/07/23  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/11/28  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/01/31  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/04/03  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/06/04  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/09/02  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/09/02  æ¸•"}},
  {"id": 42, "regDate": "2024-04-22", "returnDate": "2025-05-01", "company": "æ ªå¼ä¼šç¤¾ ï¼³Ğï¼µ", "staff": "è”µæœ¬", "name": "è‹¥æœ¨ è£•ç¾", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-06-28", "birthDate": "2024-06-19", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/06/12  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/10/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/10/24  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/12/23  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/03/04  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/05/12  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/06/04  æ¸•"}},
  {"id": 43, "regDate": "2024-05-23", "returnDate": "2025-04-07", "company": "é³´é–€ã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "èŠå· ç¾ç·’ï¼ˆç¬¬2å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2024-08-17", "dueDate": "2024-09-27", "birthDate": "2024-09-17", "childName": "å¿ƒèŒ‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/08/23  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/11/21  æ¥ æœ¬", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/11/20  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/01/24  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/03/19  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/04/14  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/04/14  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/14  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/14  å·äºº"}},
  {"id": 44, "regDate": "2024-07-08", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æ—ç£åŒ»ç§‘ç—…é™¢", "staff": "å…ç‰", "name": "ä¸Šç”° çµé¦™", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-08-08", "birthDate": "2024-08-07", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/07/24", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2024/10/21  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/10/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/12/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/02/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/04/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/06/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/06/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/06/16 R7.5.1å¾©å¸° å…ç‰"}},
  {"id": 45, "regDate": "2024-07-24", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æ—ç£åŒ»ç§‘ç—…é™¢", "staff": "å…ç‰", "name": "é˜¿éƒ¨ ç”±ä½³", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "", "birthDate": "2024-06-07", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/10/21  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/12/11  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/02/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/04/15  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/06/16  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/06/16  å…ç‰"}},
  {"id": 46, "regDate": "2024-09-06", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ æ—­æœ¨å·¥ (ã‚±ã‚¢ã‚µãƒ¼ãƒ“ã‚¹äº‹æ¥­éƒ¨)", "staff": "æ¨ªäº•", "name": "å‰ç”° å††é¦™", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-08-24", "birthDate": "2024-08-19", "childName": "åƒå¤", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2024/09/09  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2024/12/13  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/01/24  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/03/12  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/05/15  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/07/16  æ¸•"}},
  {"id": 47, "regDate": "2024-09-12", "returnDate": "", "company": "ãƒãƒ¥ãƒ­ã‚¹ãŠã˜ã•ã‚“ åˆåŒä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "åªäº• åŠ å¥ˆ", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "", "birthDate": "2023-05-20", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 48, "regDate": "2024-11-06", "returnDate": "", "company": "å²¡ç”°çµ„", "staff": "æ¨ªäº•", "name": "è—¤æ‘æ™ºä½³", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2024-04-08", "birthDate": "2024-04-08", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/11/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2024/11/06  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/01/24  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/03/25  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/05/30  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/05/30  æ¸•"}},
  {"id": 49, "regDate": "2024-11-14", "returnDate": "", "company": "(æœ‰)ã‚»ãƒ¬ãƒ¢ãƒ‹ãƒ¼ãƒ›ãƒ¼ãƒ«ã•ã ã¿ã¤", "staff": "è”µæœ¬", "name": "å–œå¤š èˆ", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2025-03-14", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 50, "regDate": "2024-02-05", "returnDate": "", "company": "é³´é–€ã‚¬ã‚¹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "è°·å· æœ±é‡Œï¼ˆç¬¬3å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2025-07-19", "birthDate": "2025-07-14", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/06/24  å·äºº", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2025/09/26  æ¥ æœ¬", "è‚²ä¼‘å…é™¤ç”³è«‹": "2025/09/17  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/11/13  å·äºº"}},
  {"id": 51, "regDate": "2025-02-06", "returnDate": "", "company": "å…ç‰äº‹å‹™æ‰€", "staff": "å…ç‰", "name": "å…ç‰ç¾å’²", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2024-11-08", "birthDate": "2024-11-05", "childName": "æŸŠæ©", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/04/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/04/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/04/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/04/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®": "2025/04/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®": "2025/04/28  å…ç‰"}},
  {"id": 52, "regDate": "2025-02-07", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ en", "staff": "è”µæœ¬", "name": "å±±ï¨‘ æœ‰å­£ç©‚", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2025-05-16", "birthDate": "2025-05-13", "childName": "é™½è‘µ", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/06/02  æ¸•", "è‚²ä¼‘å…é™¤ç”³è«‹": "2025/07/10  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/09/29  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/11/25  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2026/01/14  æ¸•"}},
  {"id": 53, "regDate": "2025-02-11", "returnDate": "", "company": "ç±³ç²‰ãƒãƒ¥ãƒ­ã‚¹ã‚¸ãƒ£ãƒ‘ãƒ³ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "å ¤ å‹é‡Œæµ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2025-03-04", "dueDate": "2025-04-14", "birthDate": "2025-03-25", "childName": "", "subsidy": "æœ‰", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 54, "regDate": "2025-03-05", "returnDate": "025/04/21", "company": "æ ªå¼ä¼šç¤¾ ã‚±ãƒ³ãƒˆãƒã‚¦ã‚¹", "staff": "è”µæœ¬", "name": "å²¡ç”° å½©èŠ±ï¼ˆç¬¬2å­ï¼‰", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2024-07-26", "birthDate": "2024-07-06", "childName": "ç‡ˆä¾", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2024/11/13  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/01/15  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/03/05  æ¸•", "è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®": "2025/05/26  æ¸•"}},
  {"id": 55, "regDate": "2025-03-19", "returnDate": "2025-10-27", "company": "æ ªå¼ä¼šç¤¾ å¤§ å‰µ", "staff": "æ¥ æœ¬", "name": "å°å· åƒä½³", "insurance": "é›‡ç”¨ä¿é™ºã®ã¿", "prenatalStart": "", "dueDate": "2027-02-17", "birthDate": "2025-02-01", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R7.10.27é€€è·", "applications": {"è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/06/05  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2025/08/01  å·äºº", "è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®": "2025/10/01  æ¸•"}},
  {"id": 56, "regDate": "2025-04-04", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "å…ç‰", "name": "åº­å±± èœã€…", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2025-06-27", "birthDate": "2025-06-27", "childName": "å¤§ç¿”ï¼ˆã²ã‚ã¨ï¼‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/05/27  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2025/08/29  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2025/08/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2025/10/28  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®": "2026/01/06  å…ç‰"}},
  {"id": 57, "regDate": "2025-06-02", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "å…ç‰", "name": "é«˜æ  çµ¢é¦™", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2025-09-04", "dueDate": "2025-10-15", "birthDate": "2025-10-04", "childName": "æ¢¨éƒ½", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/09/11  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2025/12/03  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2025/12/03  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2026/02/19  å…ç‰"}},
  {"id": 58, "regDate": "2025-06-02", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "å…ç‰", "name": "çŸ³æ©‹ é£›é³¥", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "2025-09-13", "dueDate": "2025-10-24", "birthDate": "2025-10-18", "childName": "ç‘›ç¥ï¼ˆãˆãï¼‰", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/09/25  å…ç‰", "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹": "2025/12/17  å…ç‰", "è‚²ä¼‘å…é™¤ç”³è«‹": "2025/12/17  å…ç‰", "è‚²å…çµ¦ä»˜é‡‘ / åˆå›": "2026/02/20  å…ç‰"}},
  {"id": 59, "regDate": "2025-09-17", "returnDate": "", "company": "æ¸…è¦‹é›»æ°—å·¥äº‹ æ ªå¼ä¼šç¤¾", "staff": "æ¥ æœ¬", "name": "æ§‡å¹³ æ²™å¸Œ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2026-01-10", "birthDate": "2025-12-25", "childName": "", "subsidy": "æœ‰", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "R7.12.13ã€€ç”£å‰ä¼‘æš‡é–‹å§‹äºˆå®š", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/12/26  æ¸•", "è‚²ä¼‘å…é™¤ç”³è«‹": "2026/02/20  æ¸•"}},
  {"id": 60, "regDate": "2025-11-06", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "æ°¸ä¹… è™¹", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2026-04-10", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 61, "regDate": "2025-11-13", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ãƒ†ã‚¯ãƒãƒ‡ã‚¸ã‚¿ãƒ« æ±äº¬æ”¯åº—", "staff": "è”µæœ¬", "name": "å‘å±± çµä¹ƒ", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2026-04-08", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 62, "regDate": "2025-11-13", "returnDate": "", "company": "å¾³å³¶åˆåŒè¨¼åˆ¸ æ ªå¼ä¼šç¤¾", "staff": "æ¨ªäº•", "name": "æ³Š æ„›", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2025-12-17", "birthDate": "2025-12-10", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/11/19  å…ç‰"}},
  {"id": 63, "regDate": "2025-11-14", "returnDate": "", "company": "æ ªå¼ä¼šç¤¾ ï¼¡ï¼§ï¼®", "staff": "æ¥ æœ¬", "name": "ç”°ä¸­ èˆï¼ˆç¬¬2å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2026-06-06", "birthDate": "", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {}},
  {"id": 64, "regDate": "2026-01-09", "returnDate": "", "company": "æœ‰é™ä¼šç¤¾ åŸç”°é£Ÿå“", "staff": "æ¨ªäº•", "name": "æ¾ä¹… èŒœï¼ˆç¬¬2å­ï¼‰", "insurance": "ç¤¾ï¼é›‡", "prenatalStart": "", "dueDate": "2026-01-08", "birthDate": "2025-12-24", "childName": "", "subsidy": "ç„¡", "multiple": "ç„¡", "ext1": "ç„¡", "ext2": "ç„¡", "notes": "", "applications": {"ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹": "2025/12/03  æ¸•"}}
];


// --- Helper Functions ----
function addDays(dateStr, days) {
  if (!dateStr) return "";
  const d = new Date(dateStr);
  d.setDate(d.getDate() + days);
  return d.toISOString().split("T")[0];
}

function formatDate(dateStr) {
  if (!dateStr) return "â€”";
  const d = new Date(dateStr);
  return `${d.getFullYear()}/${String(d.getMonth() + 1).padStart(2, "0")}/${String(d.getDate()).padStart(2, "0")}`;
}

function daysBetween(d1, d2) {
  if (!d1 || !d2) return null;
  const a = new Date(d1), b = new Date(d2);
  return Math.round((b - a) / (1000 * 60 * 60 * 24));
}

function calcPrenatalStart(dueDate, multiple) {
  if (!dueDate) return "";
  return addDays(dueDate, multiple === "æœ‰" ? -98 : -42);
}

function calcPostpartumEnd(birthDate) {
  if (!birthDate) return "";
  return addDays(birthDate, 56);
}

function calcChildcareStart(birthDate) {
  if (!birthDate) return "";
  return addDays(birthDate, 57);
}

function calcChildOneYear(birthDate) {
  if (!birthDate) return "";
  const d = new Date(birthDate);
  d.setFullYear(d.getFullYear() + 1);
  d.setDate(d.getDate() - 1);
  return d.toISOString().split("T")[0];
}

// Calculate 2-month periods for childcare benefits (exact calendar month intervals)
function calcBenefitPeriods(birthDate) {
  if (!birthDate) return [];
  const start = calcChildcareStart(birthDate);
  if (!start) return [];
  const periods = [];
  let current = new Date(start);
  const childOneYear = new Date(birthDate);
  childOneYear.setFullYear(childOneYear.getFullYear() + 1);
  childOneYear.setDate(childOneYear.getDate() - 1);
  for (let i = 0; i < 6; i++) {
    const s = new Date(current);
    const e = new Date(current);
    e.setMonth(e.getMonth() + 2);
    e.setDate(e.getDate() - 1);
    // Cap the last period at child's 1st birthday - 1 day
    let endDate = e;
    if (e > childOneYear) endDate = childOneYear;
    periods.push({
      start: s.toISOString().split("T")[0],
      end: endDate.toISOString().split("T")[0],
      label: i === 0 ? "åˆå›" : `${i + 1}å›ç›®`,
    });
    current = new Date(e);
    current.setDate(current.getDate() + 1);
  }
  return periods;
}

// --- Styles as CSS variables ---
const COLORS = {
  bg: "#f5f7fa",
  surface: "#ffffff",
  surfaceHover: "#f0f2f5",
  border: "#e2e5ea",
  borderLight: "#d0d4dc",
  primary: "#2563eb",
  primaryDark: "#1d4ed8",
  accent: "#e84073",
  accentGreen: "#16a34a",
  accentYellow: "#d97706",
  accentOrange: "#ea580c",
  text: "#1a1a2e",
  textMuted: "#64748b",
  textDim: "#94a3b8",
  danger: "#dc2626",
  prenatal: "#7c3aed",
  postpartum: "#db2777",
  childcare: "#0891b2",
};

// --- Icon Components ---
const Icons = {
  Baby: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="8" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>,
  Building: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 21h18M9 8h1M9 12h1M9 16h1M14 8h1M14 12h1M14 16h1M5 21V5a2 2 0 012-2h10a2 2 0 012 2v16"/></svg>,
  Calendar: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>,
  Check: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><path d="M20 6L9 17l-5-5"/></svg>,
  Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>,
  Alert: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
  Plus: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
  Search: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>,
  Close: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
  ChevronDown: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9l6 6 6-6"/></svg>,
  Edit: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>,
  List: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>,
  Grid: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>,
  File: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/></svg>,
  Archive: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 8v13H3V8M1 3h22v5H1zM10 12h4"/></svg>,
  Undo: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 7v6h6"/><path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"/></svg>,
  Trash: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>,
  Print: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9V2h12v7M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>,
};

// --- Badge Component ---
function Badge({ children, color = COLORS.primary, bg }) {
  return (
    <span style={{
      display: "inline-flex", alignItems: "center", gap: 4,
      padding: "2px 10px", borderRadius: 20, fontSize: 11, fontWeight: 600,
      letterSpacing: "0.02em",
      color: color, background: bg || `${color}18`,
      border: `1px solid ${color}30`,
      whiteSpace: "nowrap",
    }}>{children}</span>
  );
}

// --- Status Badge ---
function StatusBadge({ status }) {
  if (!status) return <span style={{ color: COLORS.textDim, fontSize: 12 }}>â€”</span>;
  if (status === "æ¸ˆ") return <Badge color={COLORS.accentGreen}><Icons.Check /> æ¸ˆ</Badge>;
  if (status.includes("ç”³è«‹ãªã—")) return <Badge color={COLORS.textMuted}>ç”³è«‹ãªã—</Badge>;
  return <Badge color={COLORS.primary}>{status}</Badge>;
}

// --- Urgency Indicator ---
function UrgencyDot({ days }) {
  if (days === null) return null;
  let color = COLORS.accentGreen;
  if (days < 0) color = COLORS.danger;
  else if (days <= 7) color = COLORS.danger;
  else if (days <= 14) color = COLORS.accentOrange;
  else if (days <= 30) color = COLORS.accentYellow;
  return (
    <span style={{
      display: "inline-block", width: 8, height: 8, borderRadius: "50%",
      background: color, boxShadow: `0 0 6px ${color}80`,
      animation: days <= 7 ? "pulse 1.5s infinite" : "none",
    }} />
  );
}

// Calculate extension periods (1æ­³6ã‚«æœˆã¾ã§) - 3 periods of 2 months each
function calcExtensionPeriods(birthDate) {
  if (!birthDate) return [];
  // Extension starts at child's 1st birthday
  const start = new Date(birthDate);
  start.setFullYear(start.getFullYear() + 1);
  const childOneAndHalf = new Date(birthDate);
  childOneAndHalf.setFullYear(childOneAndHalf.getFullYear() + 1);
  childOneAndHalf.setMonth(childOneAndHalf.getMonth() + 6);
  childOneAndHalf.setDate(childOneAndHalf.getDate() - 1);
  const periods = [];
  let current = new Date(start);
  for (let i = 0; i < 3; i++) {
    const s = new Date(current);
    const e = new Date(current);
    e.setMonth(e.getMonth() + 2);
    e.setDate(e.getDate() - 1);
    let endDate = e > childOneAndHalf ? childOneAndHalf : e;
    periods.push({
      start: s.toISOString().split("T")[0],
      end: endDate.toISOString().split("T")[0],
      label: `å»¶é•·${i + 1}å›ç›®`,
    });
    current = new Date(e);
    current.setDate(current.getDate() + 1);
  }
  return periods;
}

// Calculate re-extension periods (2æ­³ã¾ã§) - 3 periods of 2 months each
function calcReExtensionPeriods(birthDate) {
  if (!birthDate) return [];
  // Re-extension starts at child's 1.5 years
  const start = new Date(birthDate);
  start.setFullYear(start.getFullYear() + 1);
  start.setMonth(start.getMonth() + 6);
  const childTwo = new Date(birthDate);
  childTwo.setFullYear(childTwo.getFullYear() + 2);
  childTwo.setDate(childTwo.getDate() - 1);
  const periods = [];
  let current = new Date(start);
  for (let i = 0; i < 3; i++) {
    const s = new Date(current);
    const e = new Date(current);
    e.setMonth(e.getMonth() + 2);
    e.setDate(e.getDate() - 1);
    let endDate = e > childTwo ? childTwo : e;
    periods.push({
      start: s.toISOString().split("T")[0],
      end: endDate.toISOString().split("T")[0],
      label: `å†å»¶é•·${i + 1}å›ç›®`,
    });
    current = new Date(e);
    current.setDate(current.getDate() + 1);
  }
  return periods;
}

// Child age milestones
function calcChildOneAndHalf(birthDate) {
  if (!birthDate) return "";
  const d = new Date(birthDate);
  d.setFullYear(d.getFullYear() + 1);
  d.setMonth(d.getMonth() + 6);
  d.setDate(d.getDate() - 1);
  return d.toISOString().split("T")[0];
}

function calcChildTwo(birthDate) {
  if (!birthDate) return "";
  const d = new Date(birthDate);
  d.setFullYear(d.getFullYear() + 2);
  d.setDate(d.getDate() - 1);
  return d.toISOString().split("T")[0];
}
function calcProgress(person) {
  const isSocial = person.insurance === "ç¤¾ï¼é›‡";
  const birthDate = person.birthDate || person.dueDate;
  if (!birthDate) return { total: 0, done: 0, pct: 0, items: [] };
  const items = [];
  if (isSocial) {
    items.push({ type: "ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹", short: "ç”£å‰ç”£å¾Œ", done: !!(person.applications||{})["ç”£å‰ç”£å¾Œå…é™¤ç”³è«‹"] });
    items.push({ type: "å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹", short: "æ‰‹å½“é‡‘", done: !!(person.applications||{})["å‡ºç”£æ‰‹å½“é‡‘ç”³è«‹"] });
    items.push({ type: "è‚²ä¼‘å…é™¤ç”³è«‹", short: "è‚²ä¼‘å…é™¤", done: !!(person.applications||{})["è‚²ä¼‘å…é™¤ç”³è«‹"] });
  }
  ["è‚²å…çµ¦ä»˜é‡‘ / åˆå›","è‚²å…çµ¦ä»˜é‡‘ / 2å›ç›®","è‚²å…çµ¦ä»˜é‡‘ / 3å›ç›®","è‚²å…çµ¦ä»˜é‡‘ / 4å›ç›®","è‚²å…çµ¦ä»˜é‡‘ / 5å›ç›®","è‚²å…çµ¦ä»˜é‡‘ / 6å›ç›®"].forEach((key, i) => {
    items.push({ type: key, short: i === 0 ? "åˆå›" : `${i+1}å›`, done: !!(person.applications||{})[key] });
  });
  if (person.ext1 === "æœ‰") {
    ["è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 1å›ç›®","è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 2å›ç›®","è‚²å…çµ¦ä»˜é‡‘å»¶é•· / 3å›ç›®"].forEach((key, i) => {
      items.push({ type: key, short: `å»¶${i+1}`, done: !!(person.applications||{})[key] });
    });
  }
  if (person.ext2 === "æœ‰") {
    ["è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 1å›ç›®","è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 2å›ç›®","è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· / 3å›ç›®"].forEach((key, i) => {
      items.push({ type: key, short: `å†${i+1}`, done: !!(person.applications||{})[key] });
    });
  }
  const total = items.length;
  const done = items.filter(it => it.done).length;
  return { total, done, pct: total > 0 ? Math.round((done / total) * 100) : 0, items };
}

// ============================================================
// Main App Component
// ============================================================
const STORAGE_KEY_DATA = "maternity-data";
const STORAGE_KEY_DISMISSED = "maternity-dismissed";

function MaternityLeaveApp() {
  const [isAuthenticated, setIsAuthenticated] = useState(false);
  const [pwInput, setPwInput] = useState("");
  const [pwError, setPwError] = useState("");
  const [data, setData] = useState(INITIAL_DATA);
  const [selectedPerson, setSelectedPerson] = useState(null);
  const [currentView, setCurrentView] = useState("dashboard");
  const [searchQuery, setSearchQuery] = useState("");
  const [filterCompany, setFilterCompany] = useState("");
  const [filterStaff, setFilterStaff] = useState("");
  const [showRegForm, setShowRegForm] = useState(false);
  const [editingPerson, setEditingPerson] = useState(null);
  const [showAppForm, setShowAppForm] = useState(false);
  const [appFormData, setAppFormData] = useState({ type: "", date: "", staff: "" });
  const [dismissedItems, setDismissedItems] = useState(new Set());
  const [showDismissConfirm, setShowDismissConfirm] = useState(null);
  const [showArchived, setShowArchived] = useState(false);
  const [saveStatus, setSaveStatus] = useState("idle"); // idle, saving, saved, error
  const [dataLoaded, setDataLoaded] = useState(false);
  const [showPrintPreview, setShowPrintPreview] = useState(false);
  const [flowchartPreview, setFlowchartPreview] = useState(null);

  const today = new Date().toISOString().split("T")[0];

  // --- Load from persistent storage on mount ---
  useEffect(() => {
    const loadData = async () => {
      try {
        const [dataResult, dismissedResult] = await Promise.all([
          window.storage.get(STORAGE_KEY_DATA).catch(() => null),
          window.storage.get(STORAGE_KEY_DISMISSED).catch(() => null),
        ]).catch(() => [null, null]);
        // Fallback to localStorage if Firebase returned nothing
        if (!dataResult || !dataResult.value) {
          const local = localStorage.getItem("ml_maternity_data");
          if (local) dataResult = { value: local };
        }
        if (!dismissedResult || !dismissedResult.value) {
          const local = localStorage.getItem("ml_maternity_dismissed");
          if (local) dismissedResult = { value: local };
        }
        if (dataResult && dataResult.value) {
          const parsed = JSON.parse(dataResult.value);
          if (Array.isArray(parsed) && parsed.length > 0) {
            setData(parsed.map(p => ({ ...p, applications: p.applications || {} })));
          }
        }
        if (dismissedResult && dismissedResult.value) {
          const parsed = JSON.parse(dismissedResult.value);
          if (Array.isArray(parsed)) {
            setDismissedItems(new Set(parsed));
          }
        }
      } catch (e) {
        console.log("Storage load error (first use):", e);
      }
      setDataLoaded(true);
    };
    loadData();
  }, []);

  // --- Auto-save data when it changes ---
  useEffect(() => {
    if (!dataLoaded) return; // Don't save during initial load
    const saveData = async () => {
      setSaveStatus("saving");
      try {
        // Always save to localStorage first (instant, reliable)
        localStorage.setItem("ml_maternity_data", JSON.stringify(data));
        // Then try Firebase (may fail in artifact/offline)
        if (window.storage && window.storage !== localStorage) {
          const timeoutPromise = new Promise((_, reject) => setTimeout(() => reject(new Error("timeout")), 3000));
          await Promise.race([
            window.storage.set(STORAGE_KEY_DATA, JSON.stringify(data)),
            timeoutPromise
          ]).catch(e => console.log("Firebase save skipped:", e.message));
        }
        setSaveStatus("saved");
        setTimeout(() => setSaveStatus("idle"), 2000);
      } catch (e) {
        console.error("Save error:", e);
        setSaveStatus("saved"); // localStorage succeeded, so show saved
        setTimeout(() => setSaveStatus("idle"), 2000);
      }
    };
    const timer = setTimeout(saveData, 500); // Debounce 500ms
    return () => clearTimeout(timer);
  }, [data, dataLoaded]);

  // --- Auto-save dismissed items when they change ---
  useEffect(() => {
    if (!dataLoaded) return;
    const saveDismissed = async () => {
      try {
        localStorage.setItem("ml_maternity_dismissed", JSON.stringify([...dismissedItems]));
        if (window.storage && window.storage !== localStorage) {
          const timeoutPromise = new Promise((_, reject) => setTimeout(() => reject(new Error("timeout")), 3000));
          await Promise.race([
            window.storage.set(STORAGE_KEY_DISMISSED, JSON.stringify([...dismissedItems])),
            timeoutPromise
          ]).catch(() => {});
        }
      } catch (e) {
        console.error("Save dismissed error:", e);
      }
    };
    const timer = setTimeout(saveDismissed, 500);
    return () => clearTimeout(timer);
  }, [dismissedItems, dataLoaded]);

  // --- Reset to initial data ---
  const resetToInitialData = async () => {
    if (!confirm("ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸçŠ¶æ…‹ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\nã™ã¹ã¦ã®å¤‰æ›´ãŒå¤±ã‚ã‚Œã¾ã™ã€‚")) return;
    setData(INITIAL_DATA);
    setDismissedItems(new Set());
    setSelectedPerson(null);
    try {
      await window.storage.delete(STORAGE_KEY_DATA);
      await window.storage.delete(STORAGE_KEY_DISMISSED);
    } catch (e) { /* ignore */ }
    setSaveStatus("saved");
    setTimeout(() => setSaveStatus("idle"), 2000);
  };

  // Dismiss an overdue item (mark as handled)
  const dismissItem = (personId, type) => {
    const key = `${personId}-${type}`;
    setDismissedItems(prev => new Set([...prev, key]));
    setShowDismissConfirm(null);
  };

  // Restore a dismissed item
  const restoreItem = (key) => {
    setDismissedItems(prev => {
      const next = new Set(prev);
      next.delete(key);
      return next;
    });
  };

  // Dismiss all overdue items for a person
  const dismissAllForPerson = (personId) => {
    setDismissedItems(prev => {
      const next = new Set(prev);
      upcomingDeadlines
        .filter(d => d.person.id === personId && d.diff < 0)
        .forEach(d => next.add(`${personId}-${d.type}`));
      return next;
    });
  };

  // --- Delete a person ---
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(null);
  const deletePerson = (person) => {
    setData(prev => prev.filter(p => p.id !== person.id));
    if (selectedPerson?.id === person.id) setSelectedPerson(null);
    setShowDeleteConfirm(null);
  };

  // --- Edit a person ---
  const [isEditing, setIsEditing] = useState(false);
  const [editForm, setEditForm] = useState(null);

  const startEditing = (person) => {
    setEditForm({ ...person });
    setIsEditing(true);
  };

  const cancelEditing = () => {
    setEditForm(null);
    setIsEditing(false);
  };

  const saveEditing = () => {
    if (!editForm || !editForm.name || !editForm.company) return;
    setData(prev => prev.map(p => p.id === editForm.id ? { ...editForm } : p));
    setSelectedPerson({ ...editForm });
    setIsEditing(false);
    setEditForm(null);
  };

  // --- Generate Flowchart PDF (as PNG) ---
  const generateFlowchartPDF = (person, mode) => {
    // mode: "birth" = å®Ÿå‡ºç”£æ—¥ãƒ™ãƒ¼ã‚¹, "due" = å‡ºç”£äºˆå®šæ—¥ãƒ™ãƒ¼ã‚¹
    try {
      const hasBirth = !!person.birthDate;
      const hasDue = !!person.dueDate;
      if (!hasBirth && !hasDue) { alert("å‡ºç”£æ—¥ãƒ»äºˆå®šæ—¥ãŒæœªè¨­å®šã§ã™"); return; }
      const useBirth = mode === "birth" && hasBirth;
      const baseDate = useBirth ? new Date(person.birthDate) : new Date(person.dueDate || person.birthDate);
      const due = new Date(person.dueDate || person.birthDate);
      const label = useBirth ? "(å®Ÿå‡ºç”£)" : "(å‡ºç”£äºˆå®šæ—¥)";
      const multi = person.multiple === "æœ‰";
      const addD = (d, n) => { const r = new Date(d); r.setDate(r.getDate() + n); return r; };
      const ps = new Date(due); ps.setDate(ps.getDate() - (multi ? 98 : 42));
      const pe = addD(baseDate, 56), cs = addD(baseDate, 57);
      const c1 = new Date(baseDate); c1.setFullYear(c1.getFullYear() + 1); c1.setDate(c1.getDate() - 1);
      const fd = (d) => d.getFullYear() + "\u5E74" + (d.getMonth()+1) + "\u6708" + d.getDate() + "\u65E5";
      const fy = (d) => d.getFullYear() + "\u5E74 " + (d.getMonth()+1) + "\u6708";
      const W = 842, H = 595, sc = 2;
      const cv = document.createElement("canvas"); cv.width = W*sc; cv.height = H*sc;
      const g = cv.getContext("2d"); g.scale(sc, sc);
      const rr = (rx,ry,rw,rh,r,f) => { g.beginPath(); g.moveTo(rx+r,ry); g.lineTo(rx+rw-r,ry); g.arcTo(rx+rw,ry,rx+rw,ry+r,r); g.lineTo(rx+rw,ry+rh-r); g.arcTo(rx+rw,ry+rh,rx+rw-r,ry+rh,r); g.lineTo(rx+r,ry+rh); g.arcTo(rx,ry+rh,rx,ry+rh-r,r); g.lineTo(rx,ry+r); g.arcTo(rx,ry,rx+r,ry,r); g.closePath(); if(f){g.fillStyle=f;g.fill();}};
      g.fillStyle="#fff"; g.fillRect(0,0,W,H);
      g.fillStyle="#1a56db"; g.fillRect(0,0,W,3);
      g.fillStyle="#1a1a1a"; g.font='9px sans-serif'; g.fillText("\uFF08\u793E\u540D\uFF09  "+person.company,30,28);
      var nowD = new Date(); var nowStr = nowD.getFullYear()+"\u5E74 "+(nowD.getMonth()+1)+"\u6708 "+nowD.getDate()+"\u65E5 \u73FE\u5728";
      g.fillStyle="#555"; g.font='8px sans-serif'; g.fillText(nowStr,640,28);
      g.fillStyle="#1a1a1a"; g.font='9px sans-serif'; g.fillText("\uFF08\u52B4\u50CD\u8005\uFF09  "+person.name+"\u3000\u69D8\u5206",30,42);
      g.font='bold 14px sans-serif'; g.fillText("\u7523\u4F11\u30FB\u80B2\u4F11\u3000\u30D5\u30ED\u30FC\u30C1\u30E3\u30FC\u30C8 \uFF1A",155,62);
      g.fillStyle = useBirth ? "#1a56db" : "#d97706";
      g.fillText(fd(baseDate)+"\u3000\u3000"+label,370,62);
      // If showing due date, also note actual birth if available
      if (!useBirth && hasBirth) {
        g.fillStyle="#dc2626"; g.font='9px sans-serif';
        g.fillText("\u203B\u5B9F\u51FA\u7523\u65E5: "+fd(new Date(person.birthDate)),370,76);
      }
      g.fillStyle="#555"; g.font='8px sans-serif'; g.fillText("\u226A\u5B50\u304C1\u6B73\u306B\u306A\u308B\u307E\u3067\u80B2\u5150\u4F11\u696D\u30921\u56DE\u53D6\u5F97\u3059\u308B\u5834\u5408\u226B",240,useBirth ? 78 : 90);
      var sy = useBirth ? 85 : 97;
      g.strokeStyle="#d1d5db"; g.lineWidth=0.5; g.beginPath(); g.moveTo(25,sy); g.lineTo(W-25,sy); g.stroke();
      rr(28,sy+5,95,18,3,"#1a56db"); g.fillStyle="#fff"; g.font='bold 9px sans-serif'; g.fillText("\u793E \u4F1A \u4FDD \u967A",36,sy+18);
      g.fillStyle="#555"; g.font='7px sans-serif'; g.fillText("\u203B\u57FA\u672C\u7684\u306B\u7523\u524D\u7523\u5F8C\u4F11\u696D \u304A\u3088\u3073 \u80B2\u5150\u4F11\u696D \u671F\u9593\u4E2D \u306F \u4E8B\u696D\u4E3B\u30FB\u672C\u4EBA\u8CA0\u62C5\u306E\u4FDD\u967A\u6599\u306F\u514D\u9664\u3055\u308C\u307E\u3059\u3002",130,sy+18);
      var y1=sy+35; rr(28,y1,95,15,2,"#dbeafe"); g.fillStyle="#1a1a1a"; g.font='8px sans-serif'; g.fillText("\u51FA \u7523 \u4E00 \u6642 \u91D1",35,y1+11);
      g.font='7.5px sans-serif'; g.fillText("50\u4E07\u5186\uFF08\u51FA\u7523\u8CBB\u7528\u306B\u51FA\u7523\u4E00\u6642\u91D1\u3092\u76F4\u63A5\u5145\u3066\u308B\u5236\u5EA6\uFF09\u2192\u51FA\u7523\u3055\u308C\u308B\u533B\u7642\u6A5F\u95A2\u3078\u59D4\u4EFB",130,y1+11);
      g.fillStyle="#555"; g.font='6px sans-serif'; g.fillText("\u2191\u7523\u79D1\u533B\u7642\u88DC\u511F\u5236\u5EA6\u52A0\u5165\u75C5\u9662\u306B\u3066\u51FA\u7523\u306E\u5834\u5408\uFF08\u672A\u52A0\u5165\u75C5\u9662\u306E\u5834\u5408\u306F48.8\u4E07\u5186\uFF09",140,y1+24);
      var y2=y1+42; rr(28,y2,95,15,2,"#dbeafe"); g.fillStyle="#1a1a1a"; g.font='8px sans-serif'; g.fillText("\u51FA \u7523 \u624B \u5F53 \u91D1",35,y2+11);
      rr(245,y2,185,15,2,"#bfdbfe"); g.fillText("\u7523\u524D\u7523\u5F8C\u4F11\u696D\u30FB\u80B2\u5150\u4F11\u696D  \u53D6\u5F97\u7533\u51FA",252,y2+11);
      g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\u5065\u5EB7\u4FDD\u967A\u30FB\u539A\u751F\u5E74\u91D1\u4FDD\u967A\u6599 \u514D\u9664\u671F\u9593\uFF1A",440,y2+10);
      var exemptStart = (useBirth && hasDue && baseDate < ps) ? baseDate : ps;
      g.fillStyle="#dc2626"; g.font='bold 7px sans-serif'; g.fillText(fy(exemptStart)+" \uFF5E "+fy(c1),600,y2+10);
      g.fillStyle="#555"; g.font='7px sans-serif'; g.fillText("\u2193 \u5BFE\u8C61\u671F\u9593\u3001\u6A19\u6E96\u5831\u916C\u65E5\u984D\u306E\uFF12\uFF0F\uFF13\u76F8\u5F53\u984D",135,y2+26);
      g.fillText("\u7523\u5F8C\u4F11\u6687\u6E80\u4E86\u5F8C\u306B\u5354\u4F1A\u3051\u3093\u307D\u3078\u63D0\u51FA",135,y2+37);
      // Early birth detection: birth before prenatal start date
      var isEarly = useBirth && hasDue && (baseDate < ps);
      var yt=y2+62;
      if (isEarly) {
        // æ—©ç”£: no prenatal leave period
        // Red warning banner
        rr(35,yt-18,320,14,2,"#fef2f2");
        g.fillStyle="#dc2626"; g.font='bold 7px sans-serif';
        g.fillText("\u203B \u65E9\u7523\u306E\u305F\u3081\u7523\u524D\u4F11\u6687\u306A\u3057\uFF08\u4E88\u5B9A\u65E5: "+fd(due)+"\uFF09",40,yt-9);
        // No prenatal box, just postpartum + childcare
        rr(35,yt,180,26,3,"#fce7f3"); g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif';
        g.fillText(fd(baseDate)+" \u51FA\u7523 \u2192 "+fd(pe)+"\u307E\u3067\u7523\u5F8C\u4F11\u6687",40,yt+11);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\u7523\u5F8C 56\u65E5",65,yt+22);
        // Childcare box
        rr(225,yt,250,26,3,"#dcfce7"); g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif';
        g.fillText(fd(cs)+" \uFF5E "+c1.getFullYear()+"\u5E74"+String(c1.getMonth()+1)+"\u6708"+c1.getDate()+"\u65E5",230,yt+11);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\u5B50\u4F9B\u304C1\u6B73\u306B\u306A\u308B\u524D\u65E5\u307E\u3067\u4F11\u696D",250,yt+22);
        // Arrow
        g.strokeStyle="#1a1a1a"; g.lineWidth=1; g.beginPath(); g.moveTo(215,yt+10); g.lineTo(225,yt+10); g.stroke();
        // Birth marker at left edge
        g.strokeStyle="#dc2626"; g.lineWidth=1.5; g.beginPath(); g.moveTo(35,yt-4); g.lineTo(35,yt+30); g.stroke();
        g.fillStyle="#dc2626"; g.font='bold 7.5px sans-serif'; g.fillText(fd(baseDate)+" "+label,40,yt+42);
        g.fillStyle="#555"; g.font='6.5px sans-serif';
        g.fillText("\u7523\u524D\u4F11\u6687\u306A\u3057",65,yt+52);
        g.fillText("\u7523\u5F8C56\u65E5",200,yt+52);
        g.fillText("\u7523\u5F8C57\u65E5",230,yt+52);
      } else {
        // Normal: prenatal + postpartum + childcare
        rr(35,yt,160,26,3,"#fce7f3"); g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif'; g.fillText(fd(ps)+" \u7523\u524D\u4F11\u6687\u958B\u59CB",40,yt+11);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("6\u9031\u9593",85,yt+22);
        rr(200,yt,145,26,3,"#fce7f3"); g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif'; g.fillText(fd(pe)+"\u307E\u3067\u7523\u5F8C\u4F11\u6687",205,yt+11);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("8\u9031\u9593",245,yt+22);
        rr(355,yt,250,26,3,"#dcfce7"); g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif'; g.fillText(fd(cs)+" \uFF5E "+c1.getFullYear()+"\u5E74"+String(c1.getMonth()+1)+"\u6708"+c1.getDate()+"\u65E5",360,yt+11);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\u5B50\u4F9B\u304C1\u6B73\u306B\u306A\u308B\u524D\u65E5\u307E\u3067\u4F11\u696D",385,yt+22);
        g.strokeStyle="#1a1a1a"; g.lineWidth=1; g.beginPath(); g.moveTo(195,yt+10); g.lineTo(200,yt+10); g.stroke();
        g.beginPath(); g.moveTo(345,yt+10); g.lineTo(355,yt+10); g.stroke();
        // Birth/Due marker
        g.strokeStyle = useBirth ? "#dc2626" : "#d97706"; g.lineWidth=1.5;
        g.beginPath(); g.moveTo(197,yt-10); g.lineTo(197,yt+30); g.stroke();
        g.fillStyle = useBirth ? "#dc2626" : "#d97706";
        g.font='bold 7.5px sans-serif'; g.fillText(fd(baseDate)+" "+label,140,yt+42);
        g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\u7523\u524D",85,yt+52); g.fillText("\u7523\u5F8C56\u65E5",220,yt+52); g.fillText("\u7523\u5F8C57\u65E5",360,yt+52);
      }
      var yb=yt+62; rr(375,yb,200,15,2,"#fef9c3"); g.fillStyle="#1a1a1a"; g.font='8px sans-serif'; g.fillText("\u80B2\u5150\u4F11\u696D\u7D66\u4ED8\u91D1",425,yb+11);
      g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("10\u65E5\u4EE5\u5185 \u2193",375,yb+28);
      g.fillStyle="#1a1a1a"; g.font='7.5px sans-serif'; g.fillText("\u30FB\u96C7\u7528\u4FDD\u967A\u80B2\u5150\u4F11\u696D\u7D66\u4ED8\u306E\u53D7\u7D66\u8CC7\u683C\u78BA\u8A8D\u624B\u7D9A\u304D\uFF08\u6BCD\u5B50\u624B\u5E33\u30FB\u901A\u5E33\u5199\u3057\u5FC5\u8981\uFF09",135,yb+44);
      g.fillStyle="#1a56db"; g.fillText("\u4EE5\u5F8C\u30012\u30F6\u6708\u6BCE\u306B\u652F\u7D66\u7533\u8ACB\u624B\u7D9A\u304D",470,yb+44);
      g.fillStyle="#555"; g.font='6px sans-serif'; g.fillText("\u203B\u53D7\u7D66\u8CC7\u683C\u78BA\u8A8D\u624B\u7D9A\u304D\u3068\u521D\u56DE\u306E\u652F\u7D66\u7533\u8ACB\u3092\u540C\u6642\u306B\u884C\u3046\u5834\u5408",145,yb+56);
      g.fillText("\u80B2\u5150\u4F11\u696D\u958B\u59CB\u65E5\u304B\u30894\u30F6\u6708\u3092\u7D4C\u904E\u3059\u308B\u65E5\u306E\u5C5E\u3059\u308B\u6708\u672B\u65E5\u307E\u3067\uFF01",155,yb+66);
      var ye=yb+86; rr(28,ye,95,18,3,"#16a34a"); g.fillStyle="#fff"; g.font='bold 9px sans-serif'; g.fillText("\u96C7 \u7528 \u4FDD \u967A",36,ye+13);
      rr(128,ye,135,18,3,"#dcfce7"); g.fillStyle="#1a1a1a"; g.font='8px sans-serif'; g.fillText("\u80B2 \u5150 \u4F11 \u696D \u7D66 \u4ED8 \u91D1",133,ye+13);
      g.fillText("\u8CCC\u91D1\u6708\u984D \u00D7 \u226A\u958B\u59CB\u304B\u3089180\u65E5\u76EE\u307E\u3067 67\uFF05\u30FB181\u65E5\u76EE\u304B\u3089 50\uFF05\u226B",270,ye+13);
      g.fillStyle="#555"; g.font='6.5px sans-serif'; g.fillText("\uFF08\u4F11\u696D\u958B\u59CB\u6642\u8CCC\u91D1\u65E5\u984D\u00D7\u652F\u7D66\u65E5\u6570\uFF09",270,ye+26);
      g.fillStyle="#555"; g.font='6.5px sans-serif';
      g.fillText("\u203B\u793E\u4F1A\u4FDD\u967A\u6599\u514D\u9664\u671F\u9593\u306F\u3001\u80B2\u5150\u4F11\u696D\u3092\u7D42\u4E86\u3059\u308B\u65E5\u306E\u7FCC\u65E5\u304C\u5C5E\u3059\u308B\u6708\u306E\u524D\u6708\u307E\u3067\u3067\u3001\u6700\u59273\u5E74\u9593\u3067\u3059\u3002",25,H-42);
      g.fillText("\u203B\u96C7\u7528\u4FDD\u967A\u306E\u80B2\u5150\u4F11\u696D\u7D66\u4ED8\u91D1\u306B\u3064\u3044\u3066\u3001\u5B50\u304C1\u6B73\u306B\u9054\u3059\u308B\u65E5\u4EE5\u964D\u3082\u80B2\u5150\u4F11\u696D\u3092\u53D6\u5F97\u3059\u308B\u5834\u5408\u306F\u30012\u6B73\u306B\u9054\u3059\u308B\u524D\u65E5\u307E\u3067\u671F\u9593\u5EF6\u9577\u304C\u51FA\u6765\u307E\u3059\u3002",25,H-30);
      g.fillText("\u3057\u304B\u3057\u3001\u8A8D\u53EF\u4FDD\u80B2\u6240\u306B\u5165\u308C\u306A\u3044\u30FB\u990A\u80B2\u56F0\u96E3\u306A\u72B6\u614B\u306B\u306A\u3063\u305F\u5834\u5408\u306B\u306E\u307F\u652F\u7D66\u3055\u308C\u307E\u3059\u3002\u203B\u6DFB\u4ED8\u66F8\u985E\u304C\u5FC5\u8981\u3067\u3059\u203B",35,H-19);
      g.fillStyle="#1a56db"; g.fillRect(0,H-8,W,2);
      setFlowchartPreview({ name: person.name + (useBirth ? " (\u5B9F\u51FA\u7523)" : " (\u4E88\u5B9A\u65E5)"), dataUrl: cv.toDataURL("image/png") });
    } catch(e) { console.error("PDF gen error:",e); alert("\u751F\u6210\u30A8\u30E9\u30FC: "+e.message); }
  };
  const filteredData = useMemo(() => {
    return data.filter(p => {
      if (searchQuery && !p.name.includes(searchQuery) && !p.company.includes(searchQuery)) return false;
      if (filterCompany && p.company !== filterCompany) return false;
      if (filterStaff && p.staff !== filterStaff) return false;
      return true;
    });
  }, [data, searchQuery, filterCompany, filterStaff]);

  // Calculate upcoming deadlines
  const upcomingDeadlines = useMemo(() => {
    const deadlines = [];
    data.forEach(p => {
      const birthDate = p.birthDate || p.dueDate;
      if (!birthDate) return;
      const isSocial = p.insurance === "ç¤¾ï¼é›‡";
      const periods = calcBenefitPeriods(birthDate);
      APPLICATION_TYPES.forEach((type, i) => {
        if ((p.applications||{})[type]) return; // already done
        let deadline = "";
        if (i === 0 && isSocial) { // ç”£å‰ç”£å¾Œå…é™¤
          deadline = calcPrenatalStart(p.dueDate, p.multiple);
        } else if (i === 1 && isSocial) { // å‡ºç”£æ‰‹å½“é‡‘ â†’ uses childcare start (birth+57)
          deadline = calcChildcareStart(birthDate);
        } else if (i === 2 && isSocial) { // è‚²ä¼‘å…é™¤
          deadline = calcChildcareStart(birthDate);
        } else if (i >= 3 && i <= 8) { // è‚²å…çµ¦ä»˜é‡‘ åˆå›ï½6å›ç›®
          const periodIdx = i - 3;
          if (periods[periodIdx]) deadline = periods[periodIdx].end;
        } else if (i >= 9 && i <= 11 && p.ext1 === "æœ‰") { // è‚²å…çµ¦ä»˜é‡‘å»¶é•· 1-3å›ç›®
          const extPeriods = calcExtensionPeriods(birthDate);
          const extIdx = i - 9;
          if (extPeriods[extIdx]) deadline = extPeriods[extIdx].end;
        } else if (i >= 12 && i <= 14 && p.ext2 === "æœ‰") { // è‚²å…çµ¦ä»˜é‡‘å†å»¶é•· 1-3å›ç›®
          const reExtPeriods = calcReExtensionPeriods(birthDate);
          const reExtIdx = i - 12;
          if (reExtPeriods[reExtIdx]) deadline = reExtPeriods[reExtIdx].end;
        }
        // Skip items for é›‡ç”¨ä¿é™ºã®ã¿ that require ç¤¾ä¿
        if (!isSocial && i <= 2) return;
        // Skip extension items if not applicable
        if (i >= 9 && i <= 11 && p.ext1 !== "æœ‰") return;
        if (i >= 12 && i <= 14 && p.ext2 !== "æœ‰") return;
        if (!deadline) return;
        const diff = daysBetween(today, deadline);
        if (diff !== null && diff <= 60) {
          deadlines.push({ person: p, type, deadline, diff, overdue: diff < 0 });
        }
      });
    });
    return deadlines.sort((a, b) => a.diff - b.diff);
  }, [data, today]);

  // Person detail calculations
  const personCalc = useMemo(() => {
    if (!selectedPerson) return null;
    const p = selectedPerson;
    const birthDate = p.birthDate || p.dueDate;
    const dueDate = p.dueDate || p.birthDate;
    if (!birthDate) return { prenatalStart: "", postpartumEnd: "", childcareStart: "", childOneYear: "", childOneAndHalf: "", childTwo: "", benefitPeriods: [], extensionPeriods: [], reExtensionPeriods: [] };
    return {
      prenatalStart: dueDate ? calcPrenatalStart(dueDate, p.multiple) : "",
      postpartumEnd: calcPostpartumEnd(birthDate),
      childcareStart: calcChildcareStart(birthDate),
      childOneYear: calcChildOneYear(birthDate),
      childOneAndHalf: calcChildOneAndHalf(birthDate),
      childTwo: calcChildTwo(birthDate),
      benefitPeriods: calcBenefitPeriods(birthDate),
      extensionPeriods: p.ext1 === "æœ‰" ? calcExtensionPeriods(birthDate) : [],
      reExtensionPeriods: p.ext2 === "æœ‰" ? calcReExtensionPeriods(birthDate) : [],
    };
  }, [selectedPerson]);

  // Save application record
  const saveApplication = useCallback(() => {
    if (!selectedPerson || !appFormData.type || !appFormData.date || !appFormData.staff) return;
    setData(prev => prev.map(p =>
      p.id === selectedPerson.id
        ? { ...p, applications: { ...p.applications, [appFormData.type]: `${appFormData.date} ${appFormData.staff}` } }
        : p
    ));
    setSelectedPerson(prev => ({
      ...prev,
      applications: { ...prev.applications, [appFormData.type]: `${appFormData.date} ${appFormData.staff}` }
    }));
    setShowAppForm(false);
    setAppFormData({ type: "", date: "", staff: "" });
  }, [selectedPerson, appFormData]);

  // New person form
  const [newPerson, setNewPerson] = useState({
    company: "", staff: "", name: "", insurance: "ç¤¾ï¼é›‡",
    dueDate: "", birthDate: "", childName: "", subsidy: "ç„¡",
    multiple: "ç„¡", ext1: "ç„¡", ext2: "ç„¡", notes: "",
  });

  const savePerson = () => {
    if (!newPerson.name || !newPerson.company) return;
    const id = Math.max(...data.map(d => d.id), 0) + 1;
    const person = {
      ...newPerson, id, regDate: today, returnDate: "",
      prenatalStart: "", applications: {},
    };
    setData(prev => [...prev, person]);
    setShowRegForm(false);
    setNewPerson({ company: "", staff: "", name: "", insurance: "ç¤¾ï¼é›‡", dueDate: "", birthDate: "", childName: "", subsidy: "ç„¡", multiple: "ç„¡", ext1: "ç„¡", ext2: "ç„¡", notes: "" });
  };

  // --- Password Gate ---
  const checkPassword = () => {
    if (pwInput === "2525") {
      setIsAuthenticated(true);
    } else {
      setPwError("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
      setPwInput("");
    }
  };

  if (!isAuthenticated) {
    return (
      <div style={{
        minHeight: "100vh", display: "flex", alignItems: "center", justifyContent: "center",
        background: "linear-gradient(135deg, #f0f4ff 0%, #e8f5e9 100%)",
        fontFamily: "'Noto Sans JP', -apple-system, sans-serif",
      }}>
        <div style={{
          background: "white", borderRadius: 16, padding: "40px 36px", width: 340, maxWidth: "90vw",
          boxShadow: "0 8px 32px rgba(0,0,0,0.1)", textAlign: "center",
        }}>
          <div style={{ fontSize: 48, marginBottom: 16 }}>ğŸ”’</div>
          <div style={{ fontSize: 18, fontWeight: 700, marginBottom: 4, color: "#1a1a1a" }}>è‚²ä¼‘ç”£ä¼‘ ä½œæ¥­ãƒªã‚¹ãƒˆ</div>
          <div style={{ fontSize: 12, color: "#888", marginBottom: 24 }}>ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
          <input
            type="password" value={pwInput} placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"
            onChange={e => { setPwInput(e.target.value); setPwError(""); }}
            onKeyDown={e => e.key === "Enter" && checkPassword()}
            style={{
              width: "100%", padding: "12px 16px", border: "1px solid #ddd", borderRadius: 8,
              fontSize: 14, outline: "none", boxSizing: "border-box", fontFamily: "inherit",
            }}
          />
          <button onClick={checkPassword} style={{
            width: "100%", padding: 12, marginTop: 12, border: "none", borderRadius: 8,
            background: "linear-gradient(135deg, #1a56db, #1e40af)", color: "white",
            fontSize: 14, fontWeight: 600, cursor: "pointer", fontFamily: "inherit",
          }}>ãƒ­ã‚°ã‚¤ãƒ³</button>
          <div style={{ color: "#dc2626", fontSize: 12, marginTop: 10, minHeight: 18 }}>{pwError}</div>
        </div>
      </div>
    );
  }

  // --- Render ---
  return (
    <div style={{
      fontFamily: "'Noto Sans JP', 'Hiragino Sans', sans-serif",
      background: `linear-gradient(135deg, ${COLORS.bg} 0%, #e8ecf4 100%)`,
      color: COLORS.text, minHeight: "100vh",
      fontSize: 13,
    }}>
      {/* Global font import */}
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap');
        * { box-sizing: border-box; margin: 0; padding: 0; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: ${COLORS.borderLight}; border-radius: 3px; }
        input, select, textarea { font-family: inherit; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* === RESPONSIVE / MOBILE === */
        @media (max-width: 768px) {
          .responsive-nav {
            order: 3 !important;
            width: 100% !important;
          }
          .hide-mobile {
            display: none !important;
          }
          .list-layout {
            flex-direction: column !important;
          }
          .person-list-col {
            flex: 1 1 auto !important;
          }
          .detail-panel {
            position: fixed !important;
            inset: 0 !important;
            z-index: 200 !important;
            border-radius: 0 !important;
            border: none !important;
            overflow-y: auto !important;
          }
          .detail-close-btn {
            display: flex !important;
          }
        }
        @media (min-width: 769px) {
          .responsive-nav {
            order: 0 !important;
            width: auto !important;
          }
          .detail-close-btn {
            display: none !important;
          }
        }

        @media print {
          @page {
            size: A4 landscape;
            margin: 8mm;
          }
          body, html {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            color-adjust: exact !important;
          }
          /* Hide interactive elements */
          header[data-no-print],
          [data-no-print] {
            display: none !important;
          }
          button, select, input, textarea, nav {
            display: none !important;
          }
          /* Global print resets */
          * {
            animation: none !important;
            transition: none !important;
            color: #222 !important;
          }
          /* Root container */
          body > div > div {
            background: white !important;
            min-height: auto !important;
          }
          div[style*="maxWidth"] {
            max-width: 100% !important;
            padding: 4px !important;
          }
          /* --- TABLES --- */
          table {
            width: 100% !important;
            min-width: unset !important;
            font-size: 8pt !important;
            border-collapse: collapse !important;
          }
          table th, table td {
            padding: 3px 4px !important;
            border: 0.5pt solid #999 !important;
            position: static !important;
            background: white !important;
          }
          table th {
            background: #e8e8e8 !important;
            font-weight: 700 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Column group header colors */
          table th[colspan] {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Overflow containers */
          div[style*="overflowX"], div[style*="overflowY"] {
            overflow: visible !important;
            max-height: none !important;
          }
          /* --- STAT CARDS --- */
          div[style*="gridTemplateColumns"] {
            gap: 6px !important;
          }
          /* Cards */
          div[style*="borderRadius: 12"], div[style*="borderRadius: 14"] {
            border: 0.5pt solid #ccc !important;
            background: white !important;
            break-inside: avoid;
            page-break-inside: avoid;
            border-radius: 4px !important;
          }
          /* Badge styles - keep compact */
          span[style*="borderRadius: 20"] {
            border: 0.5pt solid #999 !important;
            font-size: 8pt !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Progress bars */
          div[style*="borderRadius: 2"] {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Urgency dots */
          span[style*="borderRadius: 50%"] {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Status cell backgrounds */
          td span[style*="background"] {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          /* Print header/footer */
          .print-header {
            display: block !important;
            text-align: center;
            font-size: 14pt;
            font-weight: 700;
            margin-bottom: 6px;
            padding-bottom: 6px;
            border-bottom: 1.5pt solid #333;
            color: #000 !important;
          }
          .print-date {
            display: block !important;
            text-align: right;
            font-size: 9pt;
            color: #555 !important;
            margin-bottom: 6px;
          }
          /* Detail panel for person view */
          div[style*="flex: \\"1 1 auto\\""] {
            break-inside: avoid;
            page-break-inside: avoid;
          }
          /* Person list - hide when detail is showing */
          div[style*="flex: \\"0 0 420px\\""] {
            display: none !important;
          }
        }
      `}</style>

      {/* Print-only header (hidden on screen) */}
      <div className="print-header" style={{ display: "none" }}>è‚²ä¼‘ç”£ä¼‘ ä½œæ¥­ãƒªã‚¹ãƒˆ</div>
      <div className="print-date" style={{ display: "none" }}>å°åˆ·æ—¥: {formatDate(today)}ã€€ç¾åœ¨è¡¨ç¤º: {
        currentView === "dashboard" ? "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" :
        currentView === "list" ? "è¢«ä¿é™ºè€…ä¸€è¦§" :
        currentView === "schedule" ? "ç”³è«‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«" : ""
      }</div>

      {/* Header */}
      <header data-no-print style={{
        background: `${COLORS.surface}ee`, backdropFilter: "blur(20px)",
        borderBottom: `1px solid ${COLORS.border}`,
        padding: "10px 16px", position: "sticky", top: 0, zIndex: 100,
        display: "flex", alignItems: "center", justifyContent: "space-between",
        flexWrap: "wrap", gap: 8,
      }}>
        <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
          <div style={{
            background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.accent})`,
            borderRadius: 10, padding: "6px 8px", display: "flex",
          }}>
            <Icons.Baby />
          </div>
          <div>
            <div style={{ fontSize: 15, fontWeight: 700, letterSpacing: "-0.02em" }}>è‚²ä¼‘ç”£ä¼‘ ä½œæ¥­ãƒªã‚¹ãƒˆ</div>
            <div style={{ fontSize: 10, color: COLORS.textMuted }}>å¯¾è±¡æœŸé–“ R5.3æœˆï½ ï½œ {formatDate(today)} ç¾åœ¨</div>
          </div>
        </div>

        {/* Nav */}
        <nav style={{ display: "flex", gap: 2, order: 3, width: "100%", overflowX: "auto" }}
             className="responsive-nav">
          {[
            { key: "dashboard", label: "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" },
            { key: "list", label: "è¢«ä¿é™ºè€…ä¸€è¦§" },
            { key: "schedule", label: "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«" },
          ].map(v => (
            <button key={v.key} onClick={() => setCurrentView(v.key)} style={{
              padding: "7px 16px", borderRadius: 8, border: "none", cursor: "pointer",
              fontSize: 12, fontWeight: 500, fontFamily: "inherit",
              background: currentView === v.key ? `${COLORS.primary}20` : "transparent",
              color: currentView === v.key ? COLORS.primary : COLORS.textMuted,
              transition: "all 0.2s",
            }}>{v.label}</button>
          ))}
        </nav>

        <div style={{ display: "flex", alignItems: "center", gap: 6, flexWrap: "wrap" }}>
          {/* Save status */}
          <div style={{
            display: "flex", alignItems: "center", gap: 4,
            fontSize: 10, fontWeight: 500, padding: "4px 8px", borderRadius: 6,
            transition: "all 0.3s",
            ...(saveStatus === "saving" ? { color: COLORS.accentYellow, background: `${COLORS.accentYellow}10` } :
                saveStatus === "saved" ? { color: COLORS.accentGreen, background: `${COLORS.accentGreen}10` } :
                saveStatus === "error" ? { color: COLORS.danger, background: `${COLORS.danger}10` } :
                { color: COLORS.textMuted, background: "transparent" }),
          }}>
            {saveStatus === "saving" && <><span style={{ animation: "pulse 1s infinite" }}>â—</span> ä¿å­˜ä¸­...</>}
            {saveStatus === "saved" && <><Icons.Check /> ä¿å­˜æ¸ˆã¿</>}
            {saveStatus === "error" && <><Icons.Alert /> ä¿å­˜ã‚¨ãƒ©ãƒ¼</>}
            {saveStatus === "idle" && <><span style={{ color: COLORS.accentGreen, fontSize: 8 }}>â—</span> è‡ªå‹•ä¿å­˜</>}
          </div>

          <button onClick={resetToInitialData} title="åˆæœŸãƒ‡ãƒ¼ã‚¿ã«æˆ»ã™" style={{
            display: "flex", alignItems: "center", gap: 4,
            padding: "6px 10px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
            background: "transparent", color: COLORS.textMuted,
            fontSize: 10, cursor: "pointer", fontFamily: "inherit",
          }}><Icons.Undo /> <span className="hide-mobile">ãƒªã‚»ãƒƒãƒˆ</span></button>

          <button onClick={() => setShowPrintPreview(true)} title="å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" style={{
            display: "flex", alignItems: "center", gap: 4,
            padding: "6px 10px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
            background: "transparent", color: COLORS.textMuted,
            fontSize: 10, cursor: "pointer", fontFamily: "inherit",
          }}><Icons.Print /> <span className="hide-mobile">å°åˆ·</span></button>

          <button onClick={() => setShowRegForm(true)} style={{
            display: "flex", alignItems: "center", gap: 4,
            padding: "7px 12px", borderRadius: 8, border: "none", cursor: "pointer",
            background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryDark})`,
            color: "#fff", fontSize: 11, fontWeight: 600, fontFamily: "inherit",
          }}>
            <Icons.Plus /> <span className="hide-mobile">æ–°è¦ç™»éŒ²</span>
          </button>
        </div>
      </header>

      <div data-print-area style={{ padding: "16px 12px", maxWidth: 1400, margin: "0 auto" }}>

        {/* Loading indicator */}
        {!dataLoaded && (
          <div style={{
            display: "flex", alignItems: "center", justifyContent: "center",
            padding: 60, color: COLORS.textMuted,
          }}>
            <span style={{ animation: "pulse 1s infinite", marginRight: 8 }}>â—</span>
            ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...
          </div>
        )}

        {dataLoaded && <>
        {/* === DASHBOARD VIEW === */}
        {currentView === "dashboard" && (
          <div style={{ animation: "fadeIn 0.3s ease" }}>
            {/* Stats Row */}
            <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(160px, 1fr))", gap: 12, marginBottom: 24 }}>
              {[
                { label: "ç·ç™»éŒ²æ•°", value: data.length, color: COLORS.primary, icon: <Icons.Baby />, action: () => setCurrentView("list") },
                { label: "å¯¾å¿œä¸­", value: data.filter(d => !d.returnDate).length, color: COLORS.accent, icon: <Icons.Clock />, action: () => { setFilterStaff(""); setFilterCompany(""); setCurrentView("list"); } },
                { label: "å¾©å¸°æ¸ˆ", value: data.filter(d => d.returnDate).length, color: COLORS.accentGreen, icon: <Icons.Check />, action: () => { setFilterStaff(""); setFilterCompany(""); setCurrentView("list"); } },
                { label: "æœŸé™è¶…é", value: upcomingDeadlines.filter(d => d.diff < 0 && !dismissedItems.has(`${d.person.id}-${d.type}`)).length, color: COLORS.danger, icon: <Icons.Alert />, action: () => setCurrentView("schedule") },
              ].map((stat, i) => (
                <div key={i} onClick={stat.action} style={{
                  background: COLORS.surface, borderRadius: 14,
                  border: `1px solid ${COLORS.border}`, padding: "18px 20px",
                  animation: `fadeIn 0.3s ease ${i * 0.05}s both`,
                  cursor: "pointer", transition: "all 0.2s",
                }}
                  onMouseEnter={e => { e.currentTarget.style.transform = "translateY(-2px)"; e.currentTarget.style.boxShadow = `0 4px 12px ${stat.color}20`; }}
                  onMouseLeave={e => { e.currentTarget.style.transform = "translateY(0)"; e.currentTarget.style.boxShadow = "none"; }}
                >
                  <div style={{ display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: 8 }}>
                    <span style={{ color: COLORS.textMuted, fontSize: 11, fontWeight: 500 }}>{stat.label}</span>
                    <span style={{ color: stat.color, opacity: 0.7 }}>{stat.icon}</span>
                  </div>
                  <div style={{ fontSize: 28, fontWeight: 700, color: stat.color, letterSpacing: "-0.02em" }}>
                    {stat.value}
                  </div>
                </div>
              ))}
            </div>

            {/* Upcoming Deadlines */}
            <div style={{
              background: COLORS.surface, borderRadius: 14,
              border: `1px solid ${COLORS.border}`, padding: 20, marginBottom: 24,
            }}>
              <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 16 }}>
                <Icons.Alert />
                <span style={{ fontWeight: 600, fontSize: 14 }}>ç”³è«‹ãŒå¿…è¦ãªè¢«ä¿é™ºè€…ãƒªã‚¹ãƒˆ</span>
                <span style={{ fontSize: 11, color: COLORS.textMuted }}>ï¼ˆæœŸé™è¶…é + 60æ—¥ä»¥å†…ã®æœŸé™ï¼‰</span>
              </div>
              <div style={{ overflowX: "auto" }}>
                <table style={{ width: "100%", borderCollapse: "collapse" }}>
                  <thead>
                    <tr style={{ borderBottom: `1px solid ${COLORS.border}` }}>
                      {["", "ä¼šç¤¾å", "è¢«ä¿é™ºè€…å", "çŠ¶æ³", "ç”³è«‹å†…å®¹", "æœŸé™æ—¥", ""].map((h, i) => (
                        <th key={i} style={{
                          textAlign: "left", padding: "8px 12px", fontSize: 11,
                          color: COLORS.textMuted, fontWeight: 500,
                        }}>{h}</th>
                      ))}
                    </tr>
                  </thead>
                  <tbody>
                    {/* æœŸé™è¶…éã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
                    {(() => {
                      const overdueVisible = upcomingDeadlines.filter(d => d.diff < 0 && !dismissedItems.has(`${d.person.id}-${d.type}`));
                      const overdueDismissed = upcomingDeadlines.filter(d => d.diff < 0 && dismissedItems.has(`${d.person.id}-${d.type}`));
                      return <>
                        {overdueVisible.length > 0 && (
                          <tr><td colSpan={7} style={{
                            padding: "10px 12px 6px", fontSize: 11, fontWeight: 700,
                            color: COLORS.danger, background: `${COLORS.danger}08`,
                            borderTop: `2px solid ${COLORS.danger}30`,
                          }}>
                            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                              <span>âš  æœŸé™è¶…éï¼ˆ{overdueVisible.length}ä»¶ï¼‰</span>
                              <button onClick={(e) => {
                                e.stopPropagation();
                                const ids = new Set(overdueVisible.map(d => d.person.id));
                                ids.forEach(id => dismissAllForPerson(id));
                              }} style={{
                                padding: "3px 10px", borderRadius: 6, border: `1px solid ${COLORS.danger}40`,
                                background: `${COLORS.danger}15`, color: COLORS.danger,
                                fontSize: 10, fontWeight: 600, cursor: "pointer", fontFamily: "inherit",
                                display: "flex", alignItems: "center", gap: 4,
                              }}><Icons.Archive /> ã™ã¹ã¦å¯¾å¿œæ¸ˆã¿ã«ã™ã‚‹</button>
                            </div>
                          </td></tr>
                        )}
                        {overdueVisible.map((d, i) => (
                          <tr key={`overdue-${i}`} style={{
                            borderBottom: `1px solid ${COLORS.border}10`,
                            cursor: "pointer", transition: "background 0.15s",
                            background: `${COLORS.danger}04`,
                            animation: `fadeIn 0.3s ease ${i * 0.03}s both`,
                          }} onMouseEnter={e => e.currentTarget.style.background = `${COLORS.danger}10`}
                             onMouseLeave={e => e.currentTarget.style.background = `${COLORS.danger}04`}>
                            <td style={{ padding: "10px 12px" }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}><UrgencyDot days={d.diff} /></td>
                            <td style={{ padding: "10px 12px", fontSize: 12 }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}>{d.person.company}</td>
                            <td style={{ padding: "10px 12px", fontWeight: 500 }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}>{d.person.name}</td>
                            <td style={{ padding: "10px 12px" }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}>
                              <span style={{ color: COLORS.danger, fontWeight: 600, fontSize: 12 }}>
                                {Math.abs(d.diff)}æ—¥è¶…é
                              </span>
                            </td>
                            <td style={{ padding: "10px 12px" }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}><Badge color={COLORS.danger}>{d.type}</Badge></td>
                            <td style={{ padding: "10px 12px", fontSize: 12, color: COLORS.textMuted }} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }}>{formatDate(d.deadline)}</td>
                            <td style={{ padding: "10px 8px", textAlign: "right" }}>
                              <button onClick={(e) => {
                                e.stopPropagation();
                                setShowDismissConfirm({ person: d.person, type: d.type, key: `${d.person.id}-${d.type}` });
                              }} style={{
                                padding: "4px 10px", borderRadius: 6, border: `1px solid ${COLORS.accentGreen}40`,
                                background: `${COLORS.accentGreen}10`, color: COLORS.accentGreen,
                                fontSize: 10, fontWeight: 600, cursor: "pointer", fontFamily: "inherit",
                                display: "inline-flex", alignItems: "center", gap: 3,
                                whiteSpace: "nowrap",
                              }}><Icons.Check /> å¯¾å¿œæ¸ˆã¿</button>
                            </td>
                          </tr>
                        ))}

                        {/* å¯¾å¿œæ¸ˆã¿ï¼ˆéè¡¨ç¤ºï¼‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
                        {overdueDismissed.length > 0 && (
                          <>
                            <tr><td colSpan={7} style={{
                              padding: "8px 12px 4px", fontSize: 11, fontWeight: 600,
                              color: COLORS.textMuted, background: `${COLORS.surface}`,
                              borderTop: `1px solid ${COLORS.border}`,
                            }}>
                              <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                                <span style={{ display: "flex", alignItems: "center", gap: 4 }}>
                                  <Icons.Archive /> å¯¾å¿œæ¸ˆã¿ï¼ˆ{overdueDismissed.length}ä»¶ï¼‰
                                </span>
                                <button onClick={() => setShowArchived(prev => !prev)} style={{
                                  padding: "2px 8px", borderRadius: 4, border: `1px solid ${COLORS.border}`,
                                  background: "transparent", color: COLORS.textMuted,
                                  fontSize: 10, cursor: "pointer", fontFamily: "inherit",
                                }}>{showArchived ? "éè¡¨ç¤º" : "è¡¨ç¤º"}</button>
                              </div>
                            </td></tr>
                            {showArchived && overdueDismissed.map((d, i) => (
                              <tr key={`dismissed-${i}`} style={{
                                borderBottom: `1px solid ${COLORS.border}08`,
                                opacity: 0.5, background: `${COLORS.surface}`,
                              }}>
                                <td style={{ padding: "8px 12px" }}></td>
                                <td style={{ padding: "8px 12px", fontSize: 12 }}>{d.person.company}</td>
                                <td style={{ padding: "8px 12px", fontWeight: 500, textDecoration: "line-through" }}>{d.person.name}</td>
                                <td style={{ padding: "8px 12px", fontSize: 12, color: COLORS.textMuted }}>{Math.abs(d.diff)}æ—¥è¶…é</td>
                                <td style={{ padding: "8px 12px" }}><Badge color={COLORS.textMuted}>{d.type}</Badge></td>
                                <td style={{ padding: "8px 12px", fontSize: 12, color: COLORS.textMuted }}>{formatDate(d.deadline)}</td>
                                <td style={{ padding: "8px 8px", textAlign: "right" }}>
                                  <button onClick={(e) => {
                                    e.stopPropagation();
                                    restoreItem(`${d.person.id}-${d.type}`);
                                  }} style={{
                                    padding: "4px 10px", borderRadius: 6, border: `1px solid ${COLORS.textMuted}40`,
                                    background: "transparent", color: COLORS.textMuted,
                                    fontSize: 10, cursor: "pointer", fontFamily: "inherit",
                                    display: "inline-flex", alignItems: "center", gap: 3,
                                    whiteSpace: "nowrap",
                                  }}><Icons.Undo /> æˆ»ã™</button>
                                </td>
                              </tr>
                            ))}
                          </>
                        )}
                      </>;
                    })()}

                    {/* ä»Šå¾Œã®ç”³è«‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
                    {upcomingDeadlines.filter(d => d.diff >= 0).length > 0 && (
                      <tr><td colSpan={7} style={{
                        padding: "10px 12px 6px", fontSize: 11, fontWeight: 700,
                        color: COLORS.accentYellow, background: `${COLORS.accentYellow}08`,
                        borderTop: `2px solid ${COLORS.accentYellow}30`,
                      }}>ğŸ“… ä»Šå¾Œ60æ—¥ä»¥å†…ï¼ˆ{upcomingDeadlines.filter(d => d.diff >= 0).length}ä»¶ï¼‰</td></tr>
                    )}
                    {upcomingDeadlines.filter(d => d.diff >= 0).map((d, i) => (
                      <tr key={`upcoming-${i}`} onClick={() => { setSelectedPerson(d.person); setCurrentView("list"); }} style={{
                        borderBottom: `1px solid ${COLORS.border}10`,
                        cursor: "pointer", transition: "background 0.15s",
                        animation: `fadeIn 0.3s ease ${i * 0.03}s both`,
                      }} onMouseEnter={e => e.currentTarget.style.background = COLORS.surfaceHover}
                         onMouseLeave={e => e.currentTarget.style.background = "transparent"}>
                        <td style={{ padding: "10px 12px" }}><UrgencyDot days={d.diff} /></td>
                        <td style={{ padding: "10px 12px", fontSize: 12 }}>{d.person.company}</td>
                        <td style={{ padding: "10px 12px", fontWeight: 500 }}>{d.person.name}</td>
                        <td style={{ padding: "10px 12px" }}>
                          <span style={{
                            color: d.diff <= 7 ? COLORS.accentOrange : d.diff <= 30 ? COLORS.accentYellow : COLORS.accentGreen,
                            fontWeight: 600, fontSize: 12,
                          }}>{d.diff === 0 ? "æœ¬æ—¥" : `æ®‹ã‚Š${d.diff}æ—¥`}</span>
                        </td>
                        <td style={{ padding: "10px 12px" }}><Badge color={COLORS.childcare}>{d.type}</Badge></td>
                        <td style={{ padding: "10px 12px", fontSize: 12, color: COLORS.textMuted }}>{formatDate(d.deadline)}</td>
                        <td></td>
                      </tr>
                    ))}
                    {upcomingDeadlines.filter(d => !dismissedItems.has(`${d.person.id}-${d.type}`)).length === 0 && upcomingDeadlines.length === 0 && (
                      <tr><td colSpan={7} style={{ padding: 30, textAlign: "center", color: COLORS.textMuted }}>
                        ç¾åœ¨ã€å¯¾å¿œãŒå¿…è¦ãªç”³è«‹ã¯ã‚ã‚Šã¾ã›ã‚“
                      </td></tr>
                    )}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        )}

        {/* === LIST VIEW === */}
        {currentView === "list" && (
          <div style={{ animation: "fadeIn 0.3s ease" }}>
            {/* Filters */}
            <div style={{
              display: "flex", gap: 12, marginBottom: 20, flexWrap: "wrap", alignItems: "center",
            }}>
              <div style={{ position: "relative", flex: "1 1 240px" }}>
                <span style={{ position: "absolute", left: 12, top: "50%", transform: "translateY(-50%)", color: COLORS.textMuted }}>
                  <Icons.Search />
                </span>
                <input value={searchQuery} onChange={e => setSearchQuery(e.target.value)}
                  placeholder="åå‰ãƒ»ä¼šç¤¾åã§æ¤œç´¢..."
                  style={{
                    width: "100%", padding: "9px 12px 9px 36px", borderRadius: 8,
                    border: `1px solid ${COLORS.border}`, background: COLORS.surface,
                    color: COLORS.text, fontSize: 13, outline: "none",
                  }}
                />
              </div>
              <select value={filterCompany} onChange={e => setFilterCompany(e.target.value)} style={{
                padding: "9px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: COLORS.surface, color: COLORS.text, fontSize: 12,
              }}>
                <option value="">å…¨ä¼šç¤¾</option>
                {[...new Set(data.map(d => d.company))].sort().map(c => <option key={c} value={c}>{c}</option>)}
              </select>
              <select value={filterStaff} onChange={e => setFilterStaff(e.target.value)} style={{
                padding: "9px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: COLORS.surface, color: COLORS.text, fontSize: 12,
              }}>
                <option value="">å…¨æ‹…å½“</option>
                {STAFF.map(s => <option key={s} value={s}>{s}</option>)}
              </select>
              <span style={{ fontSize: 12, color: COLORS.textMuted }}>{filteredData.length}ä»¶</span>
            </div>

            <div style={{ display: "flex", gap: 20, flexDirection: "row", position: "relative" }}
                 className="list-layout">
              {/* Person List */}
              <div style={{ flex: selectedPerson ? "0 0 420px" : "1 1 auto", transition: "flex 0.3s", minWidth: 0 }}
                   className="person-list-col">
                <div style={{ display: "flex", flexDirection: "column", gap: 8 }}>
                  {filteredData.map((p, i) => (
                    <div key={p.id} onClick={() => { setSelectedPerson(p); cancelEditing(); }}
                      style={{
                        background: selectedPerson?.id === p.id ? `${COLORS.primary}10` : COLORS.surface,
                        border: `1px solid ${selectedPerson?.id === p.id ? COLORS.primary + "40" : COLORS.border}`,
                        borderRadius: 12, padding: "14px 18px", cursor: "pointer",
                        transition: "all 0.2s",
                        animation: `fadeIn 0.25s ease ${i * 0.02}s both`,
                      }}
                      onMouseEnter={e => { if (selectedPerson?.id !== p.id) e.currentTarget.style.background = COLORS.surfaceHover; }}
                      onMouseLeave={e => { if (selectedPerson?.id !== p.id) e.currentTarget.style.background = COLORS.surface; }}
                    >
                      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 6 }}>
                        <div>
                          <div style={{ fontWeight: 600, fontSize: 14, marginBottom: 2 }}>{p.name}</div>
                          <div style={{ fontSize: 11, color: COLORS.textMuted, display: "flex", alignItems: "center", gap: 4 }}>
                            <Icons.Building /> {p.company}
                          </div>
                        </div>
                        <div style={{ display: "flex", gap: 6, alignItems: "center" }}>
                          {p.returnDate && <Badge color={COLORS.accentGreen}>å¾©å¸°æ¸ˆ</Badge>}
                          <Badge color={p.insurance === "ç¤¾ï¼é›‡" ? COLORS.primary : COLORS.accentYellow}>{p.insurance}</Badge>
                        </div>
                      </div>
                      <div style={{ display: "flex", gap: 16, fontSize: 11, color: COLORS.textMuted }}>
                        <span>äºˆå®šæ—¥: {formatDate(p.dueDate)}</span>
                        {p.birthDate && <span>å‡ºç”£æ—¥: {formatDate(p.birthDate)}</span>}
                        <span>æ‹…å½“: {p.staff}</span>
                      </div>
                      {/* Progress Bar */}
                      {(() => {
                        const prog = calcProgress(p);
                        if (prog.total === 0) return null;
                        const barColor = prog.pct === 100 ? COLORS.accentGreen : prog.pct >= 50 ? COLORS.primary : COLORS.accentYellow;
                        return (
                          <div style={{ marginTop: 8 }}>
                            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 3 }}>
                              <div style={{ display: "flex", gap: 2 }}>
                                {prog.items.map((it, idx) => (
                                  <span key={idx} title={it.type} style={{
                                    width: 6, height: 6, borderRadius: 2,
                                    background: it.done ? barColor : `${COLORS.textMuted}25`,
                                    transition: "background 0.3s",
                                  }} />
                                ))}
                              </div>
                              <span style={{ fontSize: 10, color: prog.pct === 100 ? COLORS.accentGreen : COLORS.textMuted, fontWeight: 600 }}>
                                {prog.done}/{prog.total}
                              </span>
                            </div>
                            <div style={{
                              height: 3, borderRadius: 2, background: `${COLORS.textMuted}15`, overflow: "hidden",
                            }}>
                              <div style={{
                                height: "100%", borderRadius: 2, width: `${prog.pct}%`,
                                background: `linear-gradient(90deg, ${barColor}, ${barColor}cc)`,
                                transition: "width 0.5s ease",
                              }} />
                            </div>
                          </div>
                        );
                      })()}
                    </div>
                  ))}
                </div>
              </div>

              {/* Person Detail Panel */}
              {selectedPerson && (
                <div className="detail-panel" style={{
                  flex: "1 1 auto", background: COLORS.surface, borderRadius: 14,
                  border: `1px solid ${COLORS.border}`, overflow: "hidden",
                  animation: "slideIn 0.3s ease",
                  position: "sticky", top: 80, alignSelf: "flex-start",
                  maxHeight: "calc(100vh - 100px)", overflowY: "auto",
                }}>
                  {/* Detail Header */}
                  <div style={{
                    padding: "18px 24px", borderBottom: `1px solid ${COLORS.border}`,
                    background: `linear-gradient(135deg, ${COLORS.primary}08, ${COLORS.accent}08)`,
                  }}>
                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start" }}>
                      <div>
                        <div style={{ fontSize: 18, fontWeight: 700, marginBottom: 4 }}>{selectedPerson.name}</div>
                        <div style={{ fontSize: 12, color: COLORS.textMuted }}>{selectedPerson.company}</div>
                      </div>
                      <div style={{ display: "flex", gap: 6, alignItems: "center" }}>
                        {/* Close button for mobile */}
                        <button onClick={() => setSelectedPerson(null)} className="detail-close-btn" style={{
                          display: "none", alignItems: "center", gap: 3,
                          padding: "4px 10px", borderRadius: 6, border: `1px solid ${COLORS.border}`,
                          background: COLORS.surfaceHover, color: COLORS.textMuted,
                          fontSize: 10, cursor: "pointer", fontFamily: "inherit",
                        }}>â† æˆ»ã‚‹</button>
                        {/* PDF buttons */}
                        {selectedPerson.birthDate && (
                          <button onClick={() => generateFlowchartPDF(selectedPerson, "birth")} title="å®Ÿå‡ºç”£æ—¥ãƒ™ãƒ¼ã‚¹" style={{
                            background: "none", border: `1px solid ${COLORS.primary}30`, borderRadius: 6,
                            color: COLORS.primary, cursor: "pointer", padding: "4px 8px",
                            fontSize: 9, fontWeight: 600, fontFamily: "inherit",
                            display: "flex", alignItems: "center", gap: 3,
                          }}>
                            <Icons.File /> å®Ÿå‡ºç”£
                          </button>
                        )}
                        {selectedPerson.dueDate && (
                          <button onClick={() => generateFlowchartPDF(selectedPerson, "due")} title="å‡ºç”£äºˆå®šæ—¥ãƒ™ãƒ¼ã‚¹" style={{
                            background: "none", border: `1px solid #d9770640`, borderRadius: 6,
                            color: "#d97706", cursor: "pointer", padding: "4px 8px",
                            fontSize: 9, fontWeight: 600, fontFamily: "inherit",
                            display: "flex", alignItems: "center", gap: 3,
                          }}>
                            <Icons.File /> äºˆå®šæ—¥
                          </button>
                        )}
                        {!isEditing ? (
                          <button onClick={() => startEditing(selectedPerson)} title="æƒ…å ±ã‚’ç·¨é›†" style={{
                            background: "none", border: `1px solid ${COLORS.primary}30`, borderRadius: 6,
                            color: COLORS.primary, cursor: "pointer", padding: "4px 10px",
                            fontSize: 10, fontWeight: 600, fontFamily: "inherit",
                            display: "flex", alignItems: "center", gap: 3,
                            opacity: 0.7, transition: "opacity 0.2s",
                          }} onMouseEnter={e => e.currentTarget.style.opacity = "1"}
                             onMouseLeave={e => e.currentTarget.style.opacity = "0.7"}>
                            <Icons.Edit /> ç·¨é›†
                          </button>
                        ) : (
                          <>
                            <button onClick={cancelEditing} style={{
                              background: "none", border: `1px solid ${COLORS.border}`, borderRadius: 6,
                              color: COLORS.textMuted, cursor: "pointer", padding: "4px 10px",
                              fontSize: 10, fontWeight: 600, fontFamily: "inherit",
                            }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                            <button onClick={saveEditing} style={{
                              background: COLORS.primary, border: "none", borderRadius: 6,
                              color: "#fff", cursor: "pointer", padding: "4px 12px",
                              fontSize: 10, fontWeight: 600, fontFamily: "inherit",
                              display: "flex", alignItems: "center", gap: 3,
                            }}><Icons.Check /> ä¿å­˜</button>
                          </>
                        )}
                        <button onClick={() => setShowDeleteConfirm(selectedPerson)} title="ã“ã®è¢«ä¿é™ºè€…ã‚’å‰Šé™¤" style={{
                          background: "none", border: `1px solid ${COLORS.danger}30`, borderRadius: 6,
                          color: COLORS.danger, cursor: "pointer", padding: "4px 10px",
                          fontSize: 10, fontWeight: 600, fontFamily: "inherit",
                          display: "flex", alignItems: "center", gap: 3,
                          opacity: 0.7, transition: "opacity 0.2s",
                        }} onMouseEnter={e => e.currentTarget.style.opacity = "1"}
                           onMouseLeave={e => e.currentTarget.style.opacity = "0.7"}>
                          <Icons.Trash /> å‰Šé™¤
                        </button>
                        <button onClick={() => { setSelectedPerson(null); cancelEditing(); }} style={{
                          background: "none", border: "none", color: COLORS.textMuted, cursor: "pointer", padding: 4,
                        }}><Icons.Close /></button>
                      </div>
                    </div>
                  </div>

                  <div style={{ padding: "18px 24px", maxHeight: "calc(100vh - 280px)", overflowY: "auto" }}>
                    {/* Info Grid - View or Edit mode */}
                    {!isEditing ? (
                      <div style={{
                        display: "grid", gridTemplateColumns: "1fr 1fr", gap: "10px 20px", marginBottom: 20,
                        fontSize: 12,
                      }}>
                        {[
                          ["ç™»éŒ²æ—¥", formatDate(selectedPerson.regDate)],
                          ["æ‹…å½“", selectedPerson.staff],
                          ["åŠ å…¥ä¿é™º", selectedPerson.insurance],
                          ["åŠ©æˆé‡‘", selectedPerson.subsidy],
                          ["å‡ºç”£äºˆå®šæ—¥", formatDate(selectedPerson.dueDate)],
                          ["å®Ÿå‡ºç”£æ—¥", formatDate(selectedPerson.birthDate)],
                          ["å­ã®åå‰", selectedPerson.childName || "â€”"],
                          ["å¤šèƒå¦Šå¨ ", selectedPerson.multiple],
                          ["è‚²ä¼‘å»¶é•·(1æ­³6ã‚«æœˆ)", selectedPerson.ext1],
                          ["è‚²ä¼‘å»¶é•·(2æ­³)", selectedPerson.ext2],
                          ["è·å ´å¾©å¸°æ—¥", selectedPerson.returnDate ? formatDate(selectedPerson.returnDate) : "â€”"],
                          ["å‚™è€ƒ", selectedPerson.notes || "â€”"],
                        ].map(([label, value], i) => (
                          <div key={i} style={{
                            display: "flex", justifyContent: "space-between", padding: "4px 0",
                            borderBottom: `1px solid ${COLORS.border}20`,
                            ...(i >= 10 ? { gridColumn: "span 2" } : {}),
                          }}>
                            <span style={{ color: COLORS.textMuted }}>{label}</span>
                            <span style={{ fontWeight: 500, textAlign: "right", maxWidth: "60%", wordBreak: "break-all" }}>{value}</span>
                          </div>
                        ))}
                      </div>
                    ) : editForm && (
                      <div style={{
                        display: "grid", gridTemplateColumns: "1fr 1fr", gap: "12px 16px", marginBottom: 20,
                        fontSize: 12, padding: 16, borderRadius: 10,
                        background: `${COLORS.primary}05`, border: `1px solid ${COLORS.primary}20`,
                      }}>
                        {(() => {
                          const inputStyle = {
                            width: "100%", padding: "6px 10px", borderRadius: 6,
                            border: `1px solid ${COLORS.border}`, background: COLORS.bg,
                            color: COLORS.text, fontSize: 12, fontFamily: "inherit",
                          };
                          const labelStyle = { fontSize: 10, color: COLORS.textMuted, display: "block", marginBottom: 3, fontWeight: 500 };
                          const selectStyle = { ...inputStyle };
                          return <>
                            {/* Name */}
                            <div>
                              <label style={labelStyle}>è¢«ä¿é™ºè€…å *</label>
                              <input value={editForm.name} onChange={e => setEditForm(p => ({ ...p, name: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Company */}
                            <div>
                              <label style={labelStyle}>ä¼šç¤¾å *</label>
                              <input list="edit-company-list" value={editForm.company}
                                onChange={e => setEditForm(p => ({ ...p, company: e.target.value }))}
                                style={inputStyle} />
                              <datalist id="edit-company-list">
                                {[...new Set([...COMPANIES, ...data.map(d => d.company)])].sort().map(c =>
                                  <option key={c} value={c} />
                                )}
                              </datalist>
                            </div>
                            {/* Staff */}
                            <div>
                              <label style={labelStyle}>æ‹…å½“è€…</label>
                              <input list="edit-staff-list" value={editForm.staff}
                                onChange={e => setEditForm(p => ({ ...p, staff: e.target.value }))}
                                style={inputStyle} />
                              <datalist id="edit-staff-list">
                                {[...new Set([...STAFF, ...data.map(d => d.staff)])].filter(Boolean).sort().map(s =>
                                  <option key={s} value={s} />
                                )}
                              </datalist>
                            </div>
                            {/* Insurance */}
                            <div>
                              <label style={labelStyle}>åŠ å…¥ä¿é™º</label>
                              <select value={editForm.insurance} onChange={e => setEditForm(p => ({ ...p, insurance: e.target.value }))}
                                style={selectStyle}>
                                {INSURANCE_TYPES.map(t => <option key={t} value={t}>{t}</option>)}
                              </select>
                            </div>
                            {/* Due Date */}
                            <div>
                              <label style={labelStyle}>å‡ºç”£äºˆå®šæ—¥</label>
                              <input type="date" value={editForm.dueDate}
                                onChange={e => setEditForm(p => ({ ...p, dueDate: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Birth Date */}
                            <div>
                              <label style={labelStyle}>å®Ÿå‡ºç”£æ—¥</label>
                              <input type="date" value={editForm.birthDate}
                                onChange={e => setEditForm(p => ({ ...p, birthDate: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Child Name */}
                            <div>
                              <label style={labelStyle}>å­ã®åå‰</label>
                              <input value={editForm.childName}
                                onChange={e => setEditForm(p => ({ ...p, childName: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Registration Date */}
                            <div>
                              <label style={labelStyle}>ç™»éŒ²æ—¥</label>
                              <input type="date" value={editForm.regDate}
                                onChange={e => setEditForm(p => ({ ...p, regDate: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Subsidy */}
                            <div>
                              <label style={labelStyle}>åŠ©æˆé‡‘</label>
                              <select value={editForm.subsidy} onChange={e => setEditForm(p => ({ ...p, subsidy: e.target.value }))}
                                style={selectStyle}>
                                <option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option>
                              </select>
                            </div>
                            {/* Multiple */}
                            <div>
                              <label style={labelStyle}>å¤šèƒå¦Šå¨ </label>
                              <select value={editForm.multiple} onChange={e => setEditForm(p => ({ ...p, multiple: e.target.value }))}
                                style={selectStyle}>
                                <option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option>
                              </select>
                            </div>
                            {/* Ext1 */}
                            <div>
                              <label style={labelStyle}>è‚²ä¼‘å»¶é•·(1æ­³6ã‚«æœˆ)</label>
                              <select value={editForm.ext1} onChange={e => setEditForm(p => ({ ...p, ext1: e.target.value }))}
                                style={selectStyle}>
                                <option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option>
                              </select>
                            </div>
                            {/* Ext2 */}
                            <div>
                              <label style={labelStyle}>è‚²ä¼‘å»¶é•·(2æ­³)</label>
                              <select value={editForm.ext2} onChange={e => setEditForm(p => ({ ...p, ext2: e.target.value }))}
                                style={selectStyle}>
                                <option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option>
                              </select>
                            </div>
                            {/* Return Date */}
                            <div>
                              <label style={labelStyle}>è·å ´å¾©å¸°æ—¥</label>
                              <input type="date" value={editForm.returnDate}
                                onChange={e => setEditForm(p => ({ ...p, returnDate: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Prenatal Start */}
                            <div>
                              <label style={labelStyle}>ç”£å‰ä¼‘æ¥­é–‹å§‹æ—¥</label>
                              <input type="date" value={editForm.prenatalStart}
                                onChange={e => setEditForm(p => ({ ...p, prenatalStart: e.target.value }))}
                                style={inputStyle} />
                            </div>
                            {/* Notes */}
                            <div style={{ gridColumn: "span 2" }}>
                              <label style={labelStyle}>å‚™è€ƒ</label>
                              <textarea value={editForm.notes}
                                onChange={e => setEditForm(p => ({ ...p, notes: e.target.value }))}
                                rows={2}
                                style={{ ...inputStyle, resize: "vertical" }} />
                            </div>
                          </>;
                        })()}
                      </div>
                    )}

                    {/* Timeline */}
                    {personCalc && (
                    <div style={{ marginBottom: 20 }}>
                      <div style={{ fontWeight: 600, fontSize: 13, marginBottom: 12, display: "flex", alignItems: "center", gap: 6 }}>
                        <Icons.Calendar /> æœŸé–“è¨ˆç®—
                      </div>
                      <div style={{ display: "flex", flexDirection: "column", gap: 6 }}>
                        {[
                          { label: "ç”£å‰ä¼‘æ¥­é–‹å§‹", date: personCalc.prenatalStart, color: COLORS.prenatal },
                          { label: "ç”£å¾Œä¼‘æ¥­çµ‚äº†", date: personCalc.postpartumEnd, color: COLORS.postpartum },
                          { label: "è‚²å…ä¼‘æ¥­é–‹å§‹", date: personCalc.childcareStart, color: COLORS.childcare },
                          { label: "å­ãŒ1æ­³ã«é”ã™ã‚‹æ—¥", date: personCalc.childOneYear, color: COLORS.accentYellow },
                          ...(selectedPerson.ext1 === "æœ‰" ? [{ label: "å­ãŒ1æ­³6ã‚«æœˆã«é”ã™ã‚‹æ—¥", date: personCalc.childOneAndHalf, color: COLORS.accentOrange }] : []),
                          ...(selectedPerson.ext2 === "æœ‰" ? [{ label: "å­ãŒ2æ­³ã«é”ã™ã‚‹æ—¥", date: personCalc.childTwo, color: COLORS.danger }] : []),
                        ].map((item, i) => (
                          <div key={i} style={{
                            display: "flex", alignItems: "center", gap: 12, padding: "7px 14px",
                            borderRadius: 8, background: `${item.color}08`, border: `1px solid ${item.color}20`,
                          }}>
                            <span style={{ width: 6, height: 6, borderRadius: "50%", background: item.color, flexShrink: 0 }} />
                            <span style={{ fontSize: 12, color: COLORS.textMuted, minWidth: 160 }}>{item.label}</span>
                            <span style={{ fontSize: 12, fontWeight: 600 }}>{formatDate(item.date)}</span>
                          </div>
                        ))}
                      </div>

                      {/* Benefit Period Summary */}
                      <div style={{ marginTop: 14 }}>
                        <div style={{ fontSize: 11, color: COLORS.textMuted, marginBottom: 6, fontWeight: 500 }}>çµ¦ä»˜é‡‘æœŸé–“ä¸€è¦§ <span style={{ fontSize: 10, color: COLORS.textDim }}>ï¼ˆæœªç”³è«‹ã‚’ã‚¯ãƒªãƒƒã‚¯ã§è¨˜éŒ²è¿½åŠ ï¼‰</span></div>
                        <div style={{ display: "grid", gridTemplateColumns: "auto 1fr 1fr", gap: "2px 10px", fontSize: 11 }}>
                          {personCalc.benefitPeriods.map((per, i) => {
                            const appKey = APPLICATION_TYPES[3 + i];
                            const done = !!(selectedPerson.applications||{})[appKey];
                            return [
                              <span key={`l${i}`} onClick={() => { if (!done) { setAppFormData({ type: appKey, date: "", staff: "" }); setShowAppForm(true); } }}
                                style={{ color: done ? COLORS.accentGreen : COLORS.primary, fontWeight: 500, padding: "4px 0", cursor: done ? "default" : "pointer", borderRadius: 4, transition: "background 0.15s" }}
                                onMouseEnter={e => { if (!done) e.currentTarget.style.background = `${COLORS.primary}10`; }}
                                onMouseLeave={e => { e.currentTarget.style.background = "transparent"; }}
                              >
                                {done ? "âœ“" : "â—‹"} {per.label}
                              </span>,
                              <span key={`s${i}`} style={{ color: COLORS.textMuted, padding: "4px 0" }}>{formatDate(per.start)}</span>,
                              <span key={`e${i}`} style={{ padding: "4px 0" }}>ï½ {formatDate(per.end)}</span>,
                            ];
                          })}
                          {personCalc.extensionPeriods.map((per, i) => {
                            const appKey = APPLICATION_TYPES[9 + i];
                            const done = !!(selectedPerson.applications||{})[appKey];
                            return [
                              <span key={`el${i}`} onClick={() => { if (!done) { setAppFormData({ type: appKey, date: "", staff: "" }); setShowAppForm(true); } }}
                                style={{ color: done ? COLORS.accentGreen : COLORS.accentOrange, fontWeight: 500, padding: "4px 0", cursor: done ? "default" : "pointer", borderRadius: 4, transition: "background 0.15s" }}
                                onMouseEnter={e => { if (!done) e.currentTarget.style.background = `${COLORS.accentOrange}10`; }}
                                onMouseLeave={e => { e.currentTarget.style.background = "transparent"; }}
                              >
                                {done ? "âœ“" : "â—‹"} {per.label}
                              </span>,
                              <span key={`es${i}`} style={{ color: COLORS.textMuted, padding: "4px 0" }}>{formatDate(per.start)}</span>,
                              <span key={`ee${i}`} style={{ padding: "4px 0" }}>ï½ {formatDate(per.end)}</span>,
                            ];
                          })}
                          {personCalc.reExtensionPeriods.map((per, i) => {
                            const appKey = APPLICATION_TYPES[12 + i];
                            const done = !!(selectedPerson.applications||{})[appKey];
                            return [
                              <span key={`rl${i}`} onClick={() => { if (!done) { setAppFormData({ type: appKey, date: "", staff: "" }); setShowAppForm(true); } }}
                                style={{ color: done ? COLORS.accentGreen : COLORS.danger, fontWeight: 500, padding: "4px 0", cursor: done ? "default" : "pointer", borderRadius: 4, transition: "background 0.15s" }}
                                onMouseEnter={e => { if (!done) e.currentTarget.style.background = `${COLORS.danger}10`; }}
                                onMouseLeave={e => { e.currentTarget.style.background = "transparent"; }}
                              >
                                {done ? "âœ“" : "â—‹"} {per.label}
                              </span>,
                              <span key={`rs${i}`} style={{ color: COLORS.textMuted, padding: "4px 0" }}>{formatDate(per.start)}</span>,
                              <span key={`re${i}`} style={{ padding: "4px 0" }}>ï½ {formatDate(per.end)}</span>,
                            ];
                          })}
                        </div>
                      </div>
                    </div>
                    )}

                    {/* Application Records */}
                    <div>
                      <div style={{
                        display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 12,
                      }}>
                        <div style={{ fontWeight: 600, fontSize: 13, display: "flex", alignItems: "center", gap: 6 }}>
                          <Icons.File /> ç”³è«‹è¨˜éŒ²
                        </div>
                        <button onClick={() => setShowAppForm(true)} style={{
                          display: "flex", alignItems: "center", gap: 4,
                          padding: "5px 12px", borderRadius: 6, border: `1px solid ${COLORS.primary}40`,
                          background: `${COLORS.primary}10`, color: COLORS.primary,
                          fontSize: 11, fontWeight: 500, cursor: "pointer", fontFamily: "inherit",
                        }}>
                          <Icons.Plus /> è¨˜éŒ²è¿½åŠ 
                        </button>
                      </div>

                      <div style={{ display: "flex", flexDirection: "column", gap: 4 }}>
                        {/* Base applications */}
                        {APPLICATION_TYPES.slice(0, 9).map((type, i) => {
                          const status = (selectedPerson.applications||{})[type];
                          const isSocial = selectedPerson.insurance === "ç¤¾ï¼é›‡";
                          if (!isSocial && i <= 2) return null;
                          // Find matching period for benefit types (index 3-8)
                          const periodInfo = (i >= 3 && i <= 8 && personCalc && personCalc.benefitPeriods[i - 3])
                            ? `${formatDate(personCalc.benefitPeriods[i - 3].start)}ï½${formatDate(personCalc.benefitPeriods[i - 3].end)}`
                            : null;
                          return (
                            <div key={i} onClick={() => { if (!status) { setAppFormData({ type, date: "", staff: "" }); setShowAppForm(true); } }}
                              style={{
                              display: "flex", justifyContent: "space-between", alignItems: "center",
                              padding: "7px 12px", borderRadius: 8,
                              background: status ? `${COLORS.accentGreen}05` : `${COLORS.accentYellow}05`,
                              border: `1px solid ${status ? COLORS.accentGreen + "15" : COLORS.border}20`,
                              cursor: status ? "default" : "pointer",
                              transition: "background 0.15s",
                            }}
                              onMouseEnter={e => { if (!status) e.currentTarget.style.background = `${COLORS.primary}08`; }}
                              onMouseLeave={e => { if (!status) e.currentTarget.style.background = `${COLORS.accentYellow}05`; }}
                            >
                              <div>
                                <span style={{ fontSize: 12, color: status ? COLORS.text : COLORS.textMuted }}>{type}</span>
                                {periodInfo && <div style={{ fontSize: 9, color: COLORS.textDim, marginTop: 1 }}>{periodInfo}</div>}
                              </div>
                              <StatusBadge status={status} />
                            </div>
                          );
                        })}

                        {/* Extension section */}
                        {selectedPerson.ext1 === "æœ‰" && (
                          <>
                            <div style={{ fontSize: 11, fontWeight: 600, color: COLORS.accentOrange, marginTop: 8, marginBottom: 2, padding: "0 4px" }}>
                              â–¸ å»¶é•·ç”³è«‹ï¼ˆ1æ­³6ã‚«æœˆã¾ã§ï¼‰
                            </div>
                            {APPLICATION_TYPES.slice(9, 12).map((type, i) => {
                              const status = (selectedPerson.applications||{})[type];
                              const periodInfo = (personCalc && personCalc.extensionPeriods[i])
                                ? `${formatDate(personCalc.extensionPeriods[i].start)}ï½${formatDate(personCalc.extensionPeriods[i].end)}`
                                : null;
                              return (
                                <div key={`ext-${i}`} onClick={() => { if (!status) { setAppFormData({ type, date: "", staff: "" }); setShowAppForm(true); } }}
                                  style={{
                                  display: "flex", justifyContent: "space-between", alignItems: "center",
                                  padding: "7px 12px", borderRadius: 8,
                                  background: status ? `${COLORS.accentGreen}05` : `${COLORS.accentOrange}05`,
                                  border: `1px solid ${status ? COLORS.accentGreen + "15" : COLORS.accentOrange}15`,
                                  cursor: status ? "default" : "pointer",
                                  transition: "background 0.15s",
                                }}
                                  onMouseEnter={e => { if (!status) e.currentTarget.style.background = `${COLORS.accentOrange}10`; }}
                                  onMouseLeave={e => { if (!status) e.currentTarget.style.background = `${COLORS.accentOrange}05`; }}
                                >
                                  <div>
                                    <span style={{ fontSize: 12, color: status ? COLORS.text : COLORS.textMuted }}>{type}</span>
                                    {periodInfo && <div style={{ fontSize: 9, color: COLORS.textDim, marginTop: 1 }}>{periodInfo}</div>}
                                  </div>
                                  <StatusBadge status={status} />
                                </div>
                              );
                            })}
                          </>
                        )}

                        {/* Re-extension section */}
                        {selectedPerson.ext2 === "æœ‰" && (
                          <>
                            <div style={{ fontSize: 11, fontWeight: 600, color: COLORS.danger, marginTop: 8, marginBottom: 2, padding: "0 4px" }}>
                              â–¸ å†å»¶é•·ç”³è«‹ï¼ˆ2æ­³ã¾ã§ï¼‰
                            </div>
                            {APPLICATION_TYPES.slice(12, 15).map((type, i) => {
                              const status = (selectedPerson.applications||{})[type];
                              const periodInfo = (personCalc && personCalc.reExtensionPeriods[i])
                                ? `${formatDate(personCalc.reExtensionPeriods[i].start)}ï½${formatDate(personCalc.reExtensionPeriods[i].end)}`
                                : null;
                              return (
                                <div key={`reext-${i}`} onClick={() => { if (!status) { setAppFormData({ type, date: "", staff: "" }); setShowAppForm(true); } }}
                                  style={{
                                  display: "flex", justifyContent: "space-between", alignItems: "center",
                                  padding: "7px 12px", borderRadius: 8,
                                  background: status ? `${COLORS.accentGreen}05` : `${COLORS.danger}05`,
                                  border: `1px solid ${status ? COLORS.accentGreen + "15" : COLORS.danger}15`,
                                  cursor: status ? "default" : "pointer",
                                  transition: "background 0.15s",
                                }}
                                  onMouseEnter={e => { if (!status) e.currentTarget.style.background = `${COLORS.danger}10`; }}
                                  onMouseLeave={e => { if (!status) e.currentTarget.style.background = `${COLORS.danger}05`; }}
                                >
                                  <div>
                                    <span style={{ fontSize: 12, color: status ? COLORS.text : COLORS.textMuted }}>{type}</span>
                                    {periodInfo && <div style={{ fontSize: 9, color: COLORS.textDim, marginTop: 1 }}>{periodInfo}</div>}
                                  </div>
                                  <StatusBadge status={status} />
                                </div>
                              );
                            })}
                          </>
                        )}
                      </div>
                    </div>

                    {/* Notes */}
                    {selectedPerson.notes && (
                      <div style={{
                        marginTop: 16, padding: 14, borderRadius: 8,
                        background: `${COLORS.accentYellow}08`, border: `1px solid ${COLORS.accentYellow}20`,
                        fontSize: 12,
                      }}>
                        <span style={{ color: COLORS.accentYellow, fontWeight: 600 }}>å‚™è€ƒ: </span>
                        {selectedPerson.notes}
                      </div>
                    )}
                  </div>
                </div>
              )}
            </div>
          </div>
        )}

        {/* === SCHEDULE VIEW === */}
        {currentView === "schedule" && (
          <div style={{ animation: "fadeIn 0.3s ease" }}>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }}>
              <div style={{ fontWeight: 600, fontSize: 15, display: "flex", alignItems: "center", gap: 8 }}>
                <Icons.Calendar /> ç”³è«‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« å…¨ä½“ä¸€è¦§
                <span style={{ fontSize: 11, color: COLORS.textMuted, fontWeight: 400 }}>ï¼ˆ{data.length}åï¼‰</span>
              </div>
              {/* Schedule filters */}
              <div style={{ display: "flex", gap: 8, alignItems: "center" }}>
                <select value={filterCompany} onChange={e => setFilterCompany(e.target.value)} style={{
                  padding: "6px 10px", borderRadius: 6, border: `1px solid ${COLORS.border}`,
                  background: COLORS.surface, color: COLORS.text, fontSize: 11,
                }}>
                  <option value="">å…¨ä¼šç¤¾</option>
                  {[...new Set(data.map(d => d.company))].sort().map(c => <option key={c} value={c}>{c}</option>)}
                </select>
                <select value={filterStaff} onChange={e => setFilterStaff(e.target.value)} style={{
                  padding: "6px 10px", borderRadius: 6, border: `1px solid ${COLORS.border}`,
                  background: COLORS.surface, color: COLORS.text, fontSize: 11,
                }}>
                  <option value="">å…¨æ‹…å½“</option>
                  {[...new Set(data.map(d => d.staff))].filter(Boolean).sort().map(s => <option key={s} value={s}>{s}</option>)}
                </select>
              </div>
            </div>

            {/* Legend */}
            <div style={{ display: "flex", gap: 16, marginBottom: 12, fontSize: 10, color: COLORS.textMuted, flexWrap: "wrap" }}>
              {[
                { color: COLORS.accentGreen, label: "å®Œäº†æ¸ˆã¿" },
                { color: COLORS.primary, label: "æ—¥ä»˜ã‚ã‚Šï¼ˆå‡¦ç†ä¸­ï¼‰" },
                { color: `${COLORS.textMuted}30`, label: "æœªç€æ‰‹" },
                { color: COLORS.accentOrange, label: "å»¶é•·å¯¾è±¡" },
                { color: COLORS.danger, label: "å†å»¶é•·å¯¾è±¡" },
              ].map((item, i) => (
                <span key={i} style={{ display: "flex", alignItems: "center", gap: 4 }}>
                  <span style={{ width: 10, height: 10, borderRadius: 3, background: item.color, display: "inline-block" }} />
                  {item.label}
                </span>
              ))}
            </div>

            <div style={{ overflowX: "auto", background: COLORS.surface, borderRadius: 14, border: `1px solid ${COLORS.border}` }}>
              <table style={{ width: "100%", borderCollapse: "collapse", minWidth: 1400 }}>
                <thead>
                  {/* Column group headers */}
                  <tr style={{ borderBottom: `1px solid ${COLORS.border}40` }}>
                    <th colSpan={4} style={{ padding: "6px 12px", fontSize: 10, background: `${COLORS.surface}`, textAlign: "left", color: COLORS.textMuted }}></th>
                    <th colSpan={3} style={{ padding: "6px 8px", fontSize: 10, background: `${COLORS.prenatal}10`, textAlign: "center", color: COLORS.prenatal, fontWeight: 600, borderLeft: `2px solid ${COLORS.prenatal}30` }}>ç¤¾ä¿ç”³è«‹</th>
                    <th colSpan={6} style={{ padding: "6px 8px", fontSize: 10, background: `${COLORS.childcare}10`, textAlign: "center", color: COLORS.childcare, fontWeight: 600, borderLeft: `2px solid ${COLORS.childcare}30` }}>è‚²å…çµ¦ä»˜é‡‘</th>
                    <th colSpan={3} style={{ padding: "6px 8px", fontSize: 10, background: `${COLORS.accentOrange}10`, textAlign: "center", color: COLORS.accentOrange, fontWeight: 600, borderLeft: `2px solid ${COLORS.accentOrange}30` }}>å»¶é•·</th>
                  </tr>
                  <tr style={{ borderBottom: `2px solid ${COLORS.border}` }}>
                    <th style={{ padding: "8px 8px", fontSize: 10, color: COLORS.textMuted, fontWeight: 500, textAlign: "center", position: "sticky", left: 0, background: COLORS.surface, zIndex: 2, width: 30 }}>No</th>
                    <th style={{ padding: "8px 8px", fontSize: 10, color: COLORS.textMuted, fontWeight: 500, textAlign: "left", position: "sticky", left: 30, background: COLORS.surface, zIndex: 2, minWidth: 140 }}>ä¼šç¤¾å</th>
                    <th style={{ padding: "8px 8px", fontSize: 10, color: COLORS.textMuted, fontWeight: 500, textAlign: "left", position: "sticky", left: 170, background: COLORS.surface, zIndex: 2, minWidth: 100 }}>è¢«ä¿é™ºè€…</th>
                    <th style={{ padding: "8px 4px", fontSize: 10, color: COLORS.textMuted, fontWeight: 500, textAlign: "center", width: 40 }}>é€²æ—</th>
                    {[
                      { label: "ç”£å‰ç”£å¾Œ", color: COLORS.prenatal, border: true },
                      { label: "æ‰‹å½“é‡‘", color: COLORS.prenatal },
                      { label: "è‚²ä¼‘å…é™¤", color: COLORS.prenatal },
                      { label: "åˆå›", color: COLORS.childcare, border: true },
                      { label: "2å›", color: COLORS.childcare },
                      { label: "3å›", color: COLORS.childcare },
                      { label: "4å›", color: COLORS.childcare },
                      { label: "5å›", color: COLORS.childcare },
                      { label: "6å›", color: COLORS.childcare },
                      { label: "å»¶1", color: COLORS.accentOrange, border: true },
                      { label: "å»¶2", color: COLORS.accentOrange },
                      { label: "å»¶3", color: COLORS.accentOrange },
                    ].map((col, i) => (
                      <th key={i} style={{
                        padding: "8px 4px", fontSize: 10, color: col.color, fontWeight: 600,
                        textAlign: "center", minWidth: 52, whiteSpace: "nowrap",
                        ...(col.border ? { borderLeft: `2px solid ${col.color}30` } : {}),
                      }}>{col.label}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {(filterCompany || filterStaff ? filteredData : data).map((p, idx) => {
                    const prog = calcProgress(p);
                    const isSocial = p.insurance === "ç¤¾ï¼é›‡";
                    const showTypes = APPLICATION_TYPES.slice(0, 12);
                    return (
                      <tr key={p.id} style={{
                        borderBottom: `1px solid ${COLORS.border}10`,
                        cursor: "pointer",
                        animation: `fadeIn 0.15s ease ${idx * 0.01}s both`,
                        background: prog.pct === 100 ? `${COLORS.accentGreen}04` : "transparent",
                      }}
                      onClick={() => { setSelectedPerson(p); setCurrentView("list"); }}
                      onMouseEnter={e => e.currentTarget.style.background = COLORS.surfaceHover}
                      onMouseLeave={e => e.currentTarget.style.background = prog.pct === 100 ? `${COLORS.accentGreen}04` : "transparent"}
                      >
                        <td style={{ padding: "7px 8px", fontSize: 10, color: COLORS.textMuted, textAlign: "center", position: "sticky", left: 0, background: "inherit", zIndex: 1 }}>{p.id}</td>
                        <td style={{ padding: "7px 8px", fontSize: 11, position: "sticky", left: 30, background: "inherit", zIndex: 1, maxWidth: 140, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }} title={p.company}>{p.company}</td>
                        <td style={{ padding: "7px 8px", fontSize: 12, fontWeight: 500, position: "sticky", left: 170, background: "inherit", zIndex: 1 }}>{p.name}</td>
                        {/* Progress mini bar */}
                        <td style={{ padding: "7px 4px", textAlign: "center" }}>
                          <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 2 }}>
                            <span style={{
                              fontSize: 9, fontWeight: 700,
                              color: prog.pct === 100 ? COLORS.accentGreen : prog.pct >= 50 ? COLORS.primary : COLORS.textMuted,
                            }}>{prog.pct}%</span>
                            <div style={{ width: 30, height: 3, borderRadius: 2, background: `${COLORS.textMuted}15` }}>
                              <div style={{
                                height: "100%", borderRadius: 2, width: `${prog.pct}%`,
                                background: prog.pct === 100 ? COLORS.accentGreen : prog.pct >= 50 ? COLORS.primary : COLORS.accentYellow,
                              }} />
                            </div>
                          </div>
                        </td>
                        {showTypes.map((t, i) => {
                          const status = (p.applications||{})[t];
                          const isNA = !isSocial && i <= 2;
                          const isExtNA = i >= 9 && p.ext1 !== "æœ‰";
                          if (isNA) return <td key={i} style={{ padding: "5px 3px", textAlign: "center", borderLeft: i === 0 ? `2px solid ${COLORS.prenatal}15` : "none" }}>
                            <span style={{ fontSize: 9, color: COLORS.textDim }}>N/A</span>
                          </td>;
                          if (isExtNA) return <td key={i} style={{ padding: "5px 3px", textAlign: "center", borderLeft: i === 9 ? `2px solid ${COLORS.accentOrange}15` : "none" }}>
                            <span style={{ fontSize: 9, color: COLORS.textDim }}>â€”</span>
                          </td>;
                          const borderLeft = (i === 0 || i === 3 || i === 9) ? `2px solid ${i <= 2 ? COLORS.prenatal : i <= 8 ? COLORS.childcare : COLORS.accentOrange}15` : "none";
                          return (
                            <td key={i} style={{ padding: "5px 3px", textAlign: "center", borderLeft }}>
                              {status ? (
                                status === "æ¸ˆ" || status.includes("ç”³è«‹ãªã—") || status.includes("å¾©å¸°") || status.includes("é€€è·") || status.includes("ç§»ç±") || status.includes("å¥‘ç´„çµ‚äº†") ?
                                  <span style={{
                                    display: "inline-block", width: 18, height: 18, lineHeight: "18px",
                                    borderRadius: 4, fontSize: 10, fontWeight: 700,
                                    background: status === "æ¸ˆ" || (!status.includes("ç”³è«‹ãªã—") && !status.includes("é€€è·") && !status.includes("å¥‘ç´„çµ‚äº†")) ? `${COLORS.accentGreen}20` : `${COLORS.textMuted}15`,
                                    color: status === "æ¸ˆ" || (!status.includes("ç”³è«‹ãªã—") && !status.includes("é€€è·") && !status.includes("å¥‘ç´„çµ‚äº†")) ? COLORS.accentGreen : COLORS.textMuted,
                                  }} title={status}>âœ“</span> :
                                  <span style={{
                                    display: "inline-block", padding: "2px 4px", borderRadius: 4,
                                    fontSize: 8, fontWeight: 600, maxWidth: 50, overflow: "hidden",
                                    textOverflow: "ellipsis", whiteSpace: "nowrap",
                                    background: `${COLORS.primary}15`, color: COLORS.primary,
                                  }} title={status}>
                                    {status.split(/\s+/)[0].replace(/^\d{4}\//, "")}
                                  </span>
                              ) : (
                                <span style={{
                                  display: "inline-block", width: 18, height: 18, lineHeight: "18px",
                                  borderRadius: 4, fontSize: 10, background: `${COLORS.textMuted}08`, color: COLORS.textDim,
                                }}>â€”</span>
                              )}
                            </td>
                          );
                        })}
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          </div>
        )}
        </>}
      </div>

      {/* === MODAL: Application Record === */}
      {showAppForm && selectedPerson && (
        <div style={{
          position: "fixed", inset: 0, background: "rgba(0,0,0,0.6)", backdropFilter: "blur(4px)",
          display: "flex", alignItems: "center", justifyContent: "center", zIndex: 200,
        }} onClick={() => setShowAppForm(false)}>
          <div onClick={e => e.stopPropagation()} style={{
            background: COLORS.surface, borderRadius: 16, border: `1px solid ${COLORS.border}`,
            padding: 28, width: 400, animation: "fadeIn 0.2s ease",
          }}>
            <div style={{ fontWeight: 700, fontSize: 15, marginBottom: 20 }}>ç”³è«‹è¨˜éŒ²ã®è¿½åŠ </div>
            <div style={{ marginBottom: 14 }}>
              <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>ç”³è«‹é …ç›®</label>
              <select value={appFormData.type} onChange={e => setAppFormData(p => ({ ...p, type: e.target.value }))} style={{
                width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: COLORS.bg, color: COLORS.text, fontSize: 12,
              }}>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                {APPLICATION_TYPES.filter(t => !(selectedPerson.applications || {})[t]).map(t => <option key={t} value={t}>{t}</option>)}
              </select>
            </div>
            <div style={{ marginBottom: 14 }}>
              <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>ç”³è«‹æ—¥</label>
              <input type="date" value={appFormData.date} onChange={e => setAppFormData(p => ({ ...p, date: e.target.value }))} style={{
                width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: COLORS.bg, color: COLORS.text, fontSize: 12,
              }} />
            </div>
            <div style={{ marginBottom: 20 }}>
              <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>æ‹…å½“è€…</label>
              <select value={appFormData.staff} onChange={e => setAppFormData(p => ({ ...p, staff: e.target.value }))} style={{
                width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: COLORS.bg, color: COLORS.text, fontSize: 12,
              }}>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                {STAFF.map(s => <option key={s} value={s}>{s}</option>)}
              </select>
            </div>
            <div style={{ display: "flex", gap: 10, justifyContent: "flex-end" }}>
              <button onClick={() => setShowAppForm(false)} style={{
                padding: "8px 20px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: "transparent", color: COLORS.textMuted, fontSize: 12, cursor: "pointer", fontFamily: "inherit",
              }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
              <button onClick={saveApplication} disabled={!appFormData.type || !appFormData.date || !appFormData.staff} style={{
                padding: "8px 20px", borderRadius: 8, border: "none",
                background: COLORS.primary, color: "#fff", fontSize: 12, fontWeight: 600,
                cursor: "pointer", fontFamily: "inherit",
                opacity: (!appFormData.type || !appFormData.date || !appFormData.staff) ? 0.4 : 1,
              }}>ç™»éŒ²</button>
            </div>
          </div>
        </div>
      )}

      {/* === MODAL: New Person Registration === */}
      {showRegForm && (
        <div style={{
          position: "fixed", inset: 0, background: "rgba(0,0,0,0.6)", backdropFilter: "blur(4px)",
          display: "flex", alignItems: "center", justifyContent: "center", zIndex: 200,
        }} onClick={() => setShowRegForm(false)}>
          <div onClick={e => e.stopPropagation()} style={{
            background: COLORS.surface, borderRadius: 16, border: `1px solid ${COLORS.border}`,
            padding: 20, width: "95vw", maxWidth: 520, maxHeight: "90vh", overflowY: "auto",
            animation: "fadeIn 0.2s ease",
          }}>
            <div style={{ fontWeight: 700, fontSize: 15, marginBottom: 20 }}>è¢«ä¿é™ºè€… æ–°è¦ç™»éŒ²</div>
            <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "12px 16px" }}>
              {/* Company */}
              <div style={{ gridColumn: "span 2" }}>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>ä¼šç¤¾å *</label>
                <div style={{ position: "relative" }}>
                  <input
                    list="company-list"
                    value={newPerson.company}
                    onChange={e => setNewPerson(p => ({ ...p, company: e.target.value }))}
                    placeholder="é¸æŠã¾ãŸã¯æ–°ã—ã„ä¼šç¤¾åã‚’å…¥åŠ›"
                    style={{
                      width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                      background: COLORS.bg, color: COLORS.text, fontSize: 12,
                    }}
                  />
                  <datalist id="company-list">
                    {[...new Set([...COMPANIES, ...data.map(d => d.company)])].sort().map(c =>
                      <option key={c} value={c} />
                    )}
                  </datalist>
                  {newPerson.company && !COMPANIES.includes(newPerson.company) && !data.some(d => d.company === newPerson.company) && (
                    <span style={{ fontSize: 10, color: COLORS.accentGreen, marginTop: 2, display: "block" }}>
                      âœ“ æ–°ã—ã„ä¼šç¤¾ã¨ã—ã¦ç™»éŒ²ã•ã‚Œã¾ã™
                    </span>
                  )}
                </div>
              </div>
              {/* Name */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>è¢«ä¿é™ºè€…å *</label>
                <input value={newPerson.name} onChange={e => setNewPerson(p => ({ ...p, name: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }} placeholder="å±±ç”° èŠ±å­" />
              </div>
              {/* Staff */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>æ‹…å½“è€…</label>
                <input
                  list="staff-list"
                  value={newPerson.staff}
                  onChange={e => setNewPerson(p => ({ ...p, staff: e.target.value }))}
                  placeholder="é¸æŠã¾ãŸã¯å…¥åŠ›"
                  style={{
                    width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                    background: COLORS.bg, color: COLORS.text, fontSize: 12,
                  }}
                />
                <datalist id="staff-list">
                  {[...new Set([...STAFF, ...data.map(d => d.staff)])].filter(Boolean).sort().map(s =>
                    <option key={s} value={s} />
                  )}
                </datalist>
              </div>
              {/* Insurance */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>åŠ å…¥ä¿é™º</label>
                <select value={newPerson.insurance} onChange={e => setNewPerson(p => ({ ...p, insurance: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }}>
                  {INSURANCE_TYPES.map(t => <option key={t} value={t}>{t}</option>)}
                </select>
              </div>
              {/* Due Date */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>å‡ºç”£äºˆå®šæ—¥</label>
                <input type="date" value={newPerson.dueDate} onChange={e => setNewPerson(p => ({ ...p, dueDate: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }} />
              </div>
              {/* Birth Date */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>å®Ÿå‡ºç”£æ—¥</label>
                <input type="date" value={newPerson.birthDate} onChange={e => setNewPerson(p => ({ ...p, birthDate: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }} />
              </div>
              {/* Child Name */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>å­ã®åå‰</label>
                <input value={newPerson.childName} onChange={e => setNewPerson(p => ({ ...p, childName: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }} />
              </div>
              {/* Subsidy */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>åŠ©æˆé‡‘</label>
                <select value={newPerson.subsidy} onChange={e => setNewPerson(p => ({ ...p, subsidy: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }}><option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option></select>
              </div>
              {/* Multiple */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>å¤šèƒå¦Šå¨ </label>
                <select value={newPerson.multiple} onChange={e => setNewPerson(p => ({ ...p, multiple: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }}><option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option></select>
              </div>
              {/* Extensions */}
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>è‚²ä¼‘å»¶é•·(1æ­³6ã‚«æœˆ)</label>
                <select value={newPerson.ext1} onChange={e => setNewPerson(p => ({ ...p, ext1: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }}><option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option></select>
              </div>
              <div>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>è‚²ä¼‘å»¶é•·(2æ­³)</label>
                <select value={newPerson.ext2} onChange={e => setNewPerson(p => ({ ...p, ext2: e.target.value }))} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12,
                }}><option value="ç„¡">ç„¡</option><option value="æœ‰">æœ‰</option></select>
              </div>
              {/* Notes */}
              <div style={{ gridColumn: "span 2" }}>
                <label style={{ fontSize: 11, color: COLORS.textMuted, display: "block", marginBottom: 4 }}>å‚™è€ƒ</label>
                <textarea value={newPerson.notes} onChange={e => setNewPerson(p => ({ ...p, notes: e.target.value }))} rows={2} style={{
                  width: "100%", padding: "8px 12px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                  background: COLORS.bg, color: COLORS.text, fontSize: 12, resize: "vertical",
                }} />
              </div>
            </div>
            <div style={{ display: "flex", gap: 10, justifyContent: "flex-end", marginTop: 20 }}>
              <button onClick={() => setShowRegForm(false)} style={{
                padding: "8px 20px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: "transparent", color: COLORS.textMuted, fontSize: 12, cursor: "pointer", fontFamily: "inherit",
              }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
              <button onClick={savePerson} disabled={!newPerson.name || !newPerson.company} style={{
                padding: "8px 24px", borderRadius: 8, border: "none",
                background: `linear-gradient(135deg, ${COLORS.primary}, ${COLORS.primaryDark})`,
                color: "#fff", fontSize: 12, fontWeight: 600, cursor: "pointer", fontFamily: "inherit",
                opacity: (!newPerson.name || !newPerson.company) ? 0.4 : 1,
              }}>ç™»éŒ²</button>
            </div>
          </div>
        </div>
      )}

      {/* === MODAL: Dismiss Confirmation === */}
      {showDismissConfirm && (
        <div style={{
          position: "fixed", inset: 0, background: "rgba(0,0,0,0.6)", backdropFilter: "blur(4px)",
          display: "flex", alignItems: "center", justifyContent: "center", zIndex: 300,
        }} onClick={() => setShowDismissConfirm(null)}>
          <div onClick={e => e.stopPropagation()} style={{
            background: COLORS.surface, borderRadius: 16, border: `1px solid ${COLORS.border}`,
            padding: 28, width: 420, animation: "fadeIn 0.2s ease",
          }}>
            <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 16 }}>
              <span style={{ color: COLORS.accentGreen }}><Icons.Check /></span>
              <span style={{ fontWeight: 700, fontSize: 15 }}>å¯¾å¿œæ¸ˆã¿ã«ã—ã¾ã™ã‹ï¼Ÿ</span>
            </div>
            <div style={{
              padding: 14, borderRadius: 8, background: `${COLORS.bg}`,
              border: `1px solid ${COLORS.border}`, marginBottom: 16, fontSize: 12,
            }}>
              <div style={{ marginBottom: 6 }}>
                <span style={{ color: COLORS.textMuted }}>è¢«ä¿é™ºè€…: </span>
                <span style={{ fontWeight: 600 }}>{showDismissConfirm.person.name}</span>
              </div>
              <div style={{ marginBottom: 6 }}>
                <span style={{ color: COLORS.textMuted }}>ä¼šç¤¾: </span>
                <span>{showDismissConfirm.person.company}</span>
              </div>
              <div>
                <span style={{ color: COLORS.textMuted }}>ç”³è«‹: </span>
                <Badge color={COLORS.danger}>{showDismissConfirm.type}</Badge>
              </div>
            </div>
            <div style={{ fontSize: 12, color: COLORS.textMuted, marginBottom: 20 }}>
              ã“ã®ç”³è«‹ã‚’ãƒªã‚¹ãƒˆã‹ã‚‰éè¡¨ç¤ºã«ã—ã¾ã™ã€‚ã€Œå¯¾å¿œæ¸ˆã¿ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ã„ã¤ã§ã‚‚æˆ»ã›ã¾ã™ã€‚
            </div>
            <div style={{ display: "flex", gap: 10, justifyContent: "flex-end" }}>
              <button onClick={() => setShowDismissConfirm(null)} style={{
                padding: "8px 20px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: "transparent", color: COLORS.textMuted, fontSize: 12, cursor: "pointer", fontFamily: "inherit",
              }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
              <button onClick={() => dismissItem(showDismissConfirm.person.id, showDismissConfirm.type)} style={{
                padding: "8px 20px", borderRadius: 8, border: "none",
                background: COLORS.accentGreen, color: "#fff", fontSize: 12, fontWeight: 600,
                cursor: "pointer", fontFamily: "inherit",
                display: "flex", alignItems: "center", gap: 4,
              }}><Icons.Check /> å¯¾å¿œæ¸ˆã¿ã«ã™ã‚‹</button>
            </div>
          </div>
        </div>
      )}

      {/* === MODAL: Delete Confirmation === */}
      {showDeleteConfirm && (
        <div style={{
          position: "fixed", inset: 0, background: "rgba(0,0,0,0.6)", backdropFilter: "blur(4px)",
          display: "flex", alignItems: "center", justifyContent: "center", zIndex: 300,
        }} onClick={() => setShowDeleteConfirm(null)}>
          <div onClick={e => e.stopPropagation()} style={{
            background: COLORS.surface, borderRadius: 16, border: `1px solid ${COLORS.danger}30`,
            padding: 28, width: 420, animation: "fadeIn 0.2s ease",
          }}>
            <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 16 }}>
              <span style={{ color: COLORS.danger }}><Icons.Trash /></span>
              <span style={{ fontWeight: 700, fontSize: 15 }}>è¢«ä¿é™ºè€…ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</span>
            </div>
            <div style={{
              padding: 14, borderRadius: 8, background: `${COLORS.danger}08`,
              border: `1px solid ${COLORS.danger}20`, marginBottom: 16, fontSize: 12,
            }}>
              <div style={{ marginBottom: 6 }}>
                <span style={{ color: COLORS.textMuted }}>è¢«ä¿é™ºè€…å: </span>
                <span style={{ fontWeight: 600 }}>{showDeleteConfirm.name}</span>
              </div>
              <div style={{ marginBottom: 6 }}>
                <span style={{ color: COLORS.textMuted }}>ä¼šç¤¾: </span>
                <span>{showDeleteConfirm.company}</span>
              </div>
              <div>
                <span style={{ color: COLORS.textMuted }}>ç™»éŒ²æ—¥: </span>
                <span>{formatDate(showDeleteConfirm.regDate)}</span>
              </div>
            </div>
            <div style={{ fontSize: 12, color: COLORS.danger, marginBottom: 20, lineHeight: 1.6 }}>
              âš  ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚<br/>
              ã“ã®è¢«ä¿é™ºè€…ã®å…¨ãƒ‡ãƒ¼ã‚¿ï¼ˆç”³è«‹è¨˜éŒ²ã‚’å«ã‚€ï¼‰ãŒå‰Šé™¤ã•ã‚Œã¾ã™ã€‚
            </div>
            <div style={{ display: "flex", gap: 10, justifyContent: "flex-end" }}>
              <button onClick={() => setShowDeleteConfirm(null)} style={{
                padding: "8px 20px", borderRadius: 8, border: `1px solid ${COLORS.border}`,
                background: "transparent", color: COLORS.textMuted, fontSize: 12, cursor: "pointer", fontFamily: "inherit",
              }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
              <button onClick={() => deletePerson(showDeleteConfirm)} style={{
                padding: "8px 20px", borderRadius: 8, border: "none",
                background: COLORS.danger, color: "#fff", fontSize: 12, fontWeight: 600,
                cursor: "pointer", fontFamily: "inherit",
                display: "flex", alignItems: "center", gap: 4,
              }}><Icons.Trash /> å‰Šé™¤ã™ã‚‹</button>
            </div>
          </div>
        </div>
      )}

      {/* === FLOWCHART PREVIEW MODAL === */}
      {flowchartPreview && (
        <div style={{
          position: "fixed", inset: 0, zIndex: 9999,
          background: "rgba(0,0,0,0.7)", backdropFilter: "blur(4px)",
          display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center",
        }} onClick={() => setFlowchartPreview(null)}>
          <div onClick={e => e.stopPropagation()} style={{
            background: "#fff", borderRadius: 12, padding: 12, maxWidth: "98vw", maxHeight: "95vh",
            display: "flex", flexDirection: "column", gap: 8, boxShadow: "0 20px 60px rgba(0,0,0,0.3)",
            width: "100%",
          }}>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 8 }}>
              <div style={{ fontWeight: 700, fontSize: 13, color: "#1a1a1a" }}>
                ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ â€” {flowchartPreview.name}
              </div>
              <div style={{ display: "flex", gap: 8, alignItems: "center", flexWrap: "wrap" }}>
                <span style={{ fontSize: 10, color: "#888" }}>
                  ç”»åƒã‚’é•·æŠ¼ã—/å³ã‚¯ãƒªãƒƒã‚¯ã§ä¿å­˜
                </span>
                <button onClick={() => setFlowchartPreview(null)} style={{
                  padding: "5px 14px", borderRadius: 6, border: "1px solid #ccc",
                  background: "#f5f5f5", color: "#333", fontSize: 12, cursor: "pointer", fontFamily: "inherit",
                }}>é–‰ã˜ã‚‹</button>
              </div>
            </div>
            <div style={{ overflow: "auto", maxHeight: "calc(95vh - 80px)" }}>
              <img src={flowchartPreview.dataUrl} alt="ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ"
                style={{ width: "100%", maxWidth: 900, border: "1px solid #e5e7eb", borderRadius: 4 }} />
            </div>
          </div>
        </div>
      )}

      {/* === PRINT PREVIEW === */}
      {showPrintPreview && (
        <div style={{
          position: "fixed", inset: 0, zIndex: 9999,
          background: "#fff", color: "#222",
          fontFamily: "'Noto Sans JP', sans-serif", fontSize: 11,
          overflowY: "auto",
        }}>
          {/* Print preview toolbar */}
          <div style={{
            position: "sticky", top: 0, zIndex: 10,
            background: "#f8f8f8", borderBottom: "1px solid #ddd",
            padding: "10px 20px", display: "flex", alignItems: "center", justifyContent: "space-between",
          }} className="no-print-bar">
            <span style={{ fontWeight: 700, fontSize: 14, color: "#333" }}>
              <Icons.Print /> å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
            </span>
            <div style={{ display: "flex", gap: 8 }}>
              <span style={{ fontSize: 11, color: "#888", lineHeight: "32px" }}>
                Ctrl+Pï¼ˆMac: âŒ˜+Pï¼‰ã§å°åˆ·ã§ãã¾ã™
              </span>
              <button onClick={() => setShowPrintPreview(false)} style={{
                padding: "6px 16px", borderRadius: 6, border: "1px solid #ccc",
                background: "#fff", color: "#333", fontSize: 12, cursor: "pointer",
                fontFamily: "inherit",
              }}>é–‰ã˜ã‚‹</button>
            </div>
          </div>

          <style>{`
            @media print {
              .no-print-bar { display: none !important; }
              @page { size: A4 landscape; margin: 8mm; }
            }
          `}</style>

          {/* Printable content */}
          <div style={{ padding: "16px 24px", maxWidth: 1200, margin: "0 auto" }}>
            <div style={{ textAlign: "center", fontSize: 18, fontWeight: 700, borderBottom: "2px solid #333", paddingBottom: 6, marginBottom: 4 }}>
              è‚²ä¼‘ç”£ä¼‘ ä½œæ¥­ãƒªã‚¹ãƒˆ
            </div>
            <div style={{ textAlign: "right", fontSize: 10, color: "#666", marginBottom: 12 }}>
              å°åˆ·æ—¥: {formatDate(today)} ï½œ è¡¨ç¤º: {
                currentView === "dashboard" ? "ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" :
                currentView === "list" ? "è¢«ä¿é™ºè€…ä¸€è¦§" :
                currentView === "schedule" ? "ç”³è«‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«" : ""
              }
            </div>

            {/* Dashboard print */}
            {currentView === "dashboard" && (() => {
              const overdueActive = upcomingDeadlines.filter(d => d.diff < 0 && !dismissedItems.has(`${d.person.id}-${d.type}`));
              const upcoming = upcomingDeadlines.filter(d => d.diff >= 0);
              return (
                <div>
                  {/* Summary stats */}
                  <div style={{ display: "flex", gap: 12, marginBottom: 16, fontSize: 12 }}>
                    <span><strong>ç·ç™»éŒ²æ•°:</strong> {data.length}å</span>
                    <span style={{ color: "#c00" }}><strong>æœŸé™è¶…é:</strong> {overdueActive.length}ä»¶</span>
                    <span style={{ color: "#d97706" }}><strong>ä»Šå¾Œ60æ—¥:</strong> {upcoming.length}ä»¶</span>
                  </div>

                  {/* Overdue table */}
                  {overdueActive.length > 0 && (
                    <>
                      <div style={{ fontSize: 13, fontWeight: 700, color: "#c00", marginBottom: 6 }}>âš  æœŸé™è¶…éï¼ˆ{overdueActive.length}ä»¶ï¼‰</div>
                      <table style={{ width: "100%", borderCollapse: "collapse", marginBottom: 16, fontSize: 10 }}>
                        <thead>
                          <tr style={{ background: "#fee2e2" }}>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ä¼šç¤¾å</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>è¢«ä¿é™ºè€…å</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "center" }}>è¶…éæ—¥æ•°</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ç”³è«‹å†…å®¹</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>æœŸé™æ—¥</th>
                          </tr>
                        </thead>
                        <tbody>
                          {overdueActive.map((d, i) => (
                            <tr key={i}>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{d.person.company}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc", fontWeight: 600 }}>{d.person.name}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc", textAlign: "center", color: "#c00", fontWeight: 700 }}>{Math.abs(d.diff)}æ—¥</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{d.type}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{formatDate(d.deadline)}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </>
                  )}

                  {/* Upcoming table */}
                  {upcoming.length > 0 && (
                    <>
                      <div style={{ fontSize: 13, fontWeight: 700, color: "#d97706", marginBottom: 6 }}>ğŸ“… ä»Šå¾Œ60æ—¥ä»¥å†…ï¼ˆ{upcoming.length}ä»¶ï¼‰</div>
                      <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 10 }}>
                        <thead>
                          <tr style={{ background: "#fef9c3" }}>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ä¼šç¤¾å</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>è¢«ä¿é™ºè€…å</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "center" }}>æ®‹ã‚Šæ—¥æ•°</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ç”³è«‹å†…å®¹</th>
                            <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>æœŸé™æ—¥</th>
                          </tr>
                        </thead>
                        <tbody>
                          {upcoming.map((d, i) => (
                            <tr key={i}>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{d.person.company}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc", fontWeight: 600 }}>{d.person.name}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc", textAlign: "center", fontWeight: 600 }}>{d.diff === 0 ? "æœ¬æ—¥" : `${d.diff}æ—¥`}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{d.type}</td>
                              <td style={{ padding: "4px 8px", border: "1px solid #ccc" }}>{formatDate(d.deadline)}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </>
                  )}
                </div>
              );
            })()}

            {/* List print */}
            {currentView === "list" && (
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 10 }}>
                <thead>
                  <tr style={{ background: "#f0f0f0" }}>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>No</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ä¼šç¤¾å</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>è¢«ä¿é™ºè€…å</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>ä¿é™º</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>æ‹…å½“</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>äºˆå®šæ—¥</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>å‡ºç”£æ—¥</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "center" }}>é€²æ—</th>
                    <th style={{ padding: "5px 8px", border: "1px solid #ccc", textAlign: "left" }}>çŠ¶æ…‹</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredData.map((p, i) => {
                    const prog = calcProgress(p);
                    return (
                      <tr key={p.id}>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{p.id}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{p.company}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc", fontWeight: 600 }}>{p.name}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{p.insurance}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{p.staff}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{formatDate(p.dueDate)}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{formatDate(p.birthDate)}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc", textAlign: "center", fontWeight: 600 }}>{prog.done}/{prog.total}</td>
                        <td style={{ padding: "3px 8px", border: "1px solid #ccc" }}>{p.returnDate ? "å¾©å¸°æ¸ˆ" : prog.pct === 100 ? "å®Œäº†" : "é€²è¡Œä¸­"}</td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            )}

            {/* Schedule print */}
            {currentView === "schedule" && (
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 8 }}>
                <thead>
                  <tr style={{ background: "#f0f0f0" }}>
                    <th style={{ padding: "4px", border: "1px solid #ccc", textAlign: "left" }}>No</th>
                    <th style={{ padding: "4px", border: "1px solid #ccc", textAlign: "left" }}>ä¼šç¤¾å</th>
                    <th style={{ padding: "4px", border: "1px solid #ccc", textAlign: "left" }}>è¢«ä¿é™ºè€…</th>
                    <th style={{ padding: "4px", border: "1px solid #ccc", textAlign: "center" }}>é€²æ—</th>
                    {["ç”£å‰ç”£å¾Œ","æ‰‹å½“é‡‘","è‚²ä¼‘å…é™¤","åˆå›","2å›","3å›","4å›","5å›","6å›","å»¶1","å»¶2","å»¶3"].map((h,i) => (
                      <th key={i} style={{
                        padding: "4px 2px", border: "1px solid #ccc", textAlign: "center",
                        background: i < 3 ? "#fce7f3" : i < 9 ? "#e0f2fe" : "#fff7ed",
                        fontSize: 7,
                      }}>{h}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {(filterCompany || filterStaff ? filteredData : data).map((p) => {
                    const prog = calcProgress(p);
                    const isSocial = p.insurance === "ç¤¾ï¼é›‡";
                    const types = APPLICATION_TYPES.slice(0, 12);
                    return (
                      <tr key={p.id}>
                        <td style={{ padding: "3px 4px", border: "1px solid #ccc" }}>{p.id}</td>
                        <td style={{ padding: "3px 4px", border: "1px solid #ccc", maxWidth: 120, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }}>{p.company}</td>
                        <td style={{ padding: "3px 4px", border: "1px solid #ccc", fontWeight: 600 }}>{p.name}</td>
                        <td style={{ padding: "3px 4px", border: "1px solid #ccc", textAlign: "center" }}>{prog.pct}%</td>
                        {types.map((t, i) => {
                          const status = (p.applications||{})[t];
                          const isNA = !isSocial && i <= 2;
                          const isExtNA = i >= 9 && p.ext1 !== "æœ‰";
                          return (
                            <td key={i} style={{
                              padding: "2px", border: "1px solid #ccc", textAlign: "center", fontSize: 7,
                            }}>
                              {isNA ? "â€”" : isExtNA ? "â€”" : status ? (
                                status === "æ¸ˆ" || status.includes("ç”³è«‹ãªã—") || status.includes("å¾©å¸°") || status.includes("é€€è·") ? "âœ“" :
                                status.split(/\s+/)[0].replace(/^\d{4}\//, "")
                              ) : ""}
                            </td>
                          );
                        })}
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            )}
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(MaternityLeaveApp));
  </script>
</body>
</html>